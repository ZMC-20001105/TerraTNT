# 论文叙事过渡：从概率预测到目标驱动确定性预测

> 本文件提供具体的修改文本，用于解决第一章不确定性建模综述与第四章确定性预测方法之间的逻辑断裂。
> 所有修改文本可直接复制粘贴到Word中。

---

## 核心论点

**你的方法确实处理了不确定性，只是处理方式不同：**

| 方法 | 不确定性建模位置 | 输出形式 | 代表工作 |
|------|----------------|---------|---------|
| MDN/CVAE | 轨迹本身 | 概率分布 p(τ\|x) | Social-GAN, Trajectron++ |
| **目标驱动（你的方法）** | **目的地选择** | **P(g\|x) × τ(g)** | **TNT, PECNet, 本文TerraTNT** |

你的目标分类器输出的 `softmax(goal_logits)` 就是对目的地的概率分布 P(g|x)，
然后对每个目的地生成确定性轨迹 τ(g)。这是TNT系列方法的标准范式。

**关键优势论述**：在60分钟长时域预测中，轨迹级概率分布会随时间发散（方差爆炸），
而目的地级概率分布是有界的（候选终点集合是有限的）。

---

## 修改1：第一章末尾添加过渡段落

**位置**：在表1.3"概率输出方法对比"之后，第一章总结/研究路线选择之前

**插入以下段落**：

> 上述概率预测方法在短时域（秒级）行人轨迹预测中取得了显著成效。然而，将其直接应用于本文面向的长时域（60分钟）地面目标预测场景时，面临以下挑战：
>
> （1）**预测时域长导致分布发散**。混合密度网络（MDN）和条件变分自编码器（CVAE）等方法输出的概率分布，其方差随预测时域的增长而快速膨胀。在60分钟的预测窗口内，高斯混合分布的覆盖范围可能扩展至数十公里，失去实际指导意义。
>
> （2）**地形约束使轨迹空间高度结构化**。与城市道路或开放空间中的行人不同，地面目标的运动受地形、地表覆盖和道路网络的强约束。在给定起点和终点的条件下，可行轨迹的空间分布远比自由运动场景更为集中，轨迹本身的随机性相对较低。
>
> （3）**不确定性的主要来源是目的地选择**。对于长时域预测，最大的不确定性不在于"如何到达目的地"（轨迹形态），而在于"目的地在哪里"（意图判断）。这一特点使得将不确定性建模集中在目的地选择阶段成为更合理的策略。
>
> 基于上述分析，近年来以TNT[28]和PECNet[27]为代表的目标驱动预测方法提供了一种替代思路：将预测问题分解为"目的地概率估计"和"条件轨迹生成"两个阶段。目的地概率估计阶段通过分类器对候选终点进行概率评分，显式建模目的地的不确定性；条件轨迹生成阶段在给定终点条件下生成确定性的最优路径。这种"分而治之"的策略既保留了对不确定性的建模能力，又避免了长时域概率分布发散的问题。本文第四章提出的TerraTNT模型即采用这一技术路线。

---

## 修改2：第一章1.3节"研究内容"中关于第四章的描述

**找到类似"第四章...预测概率分布"的描述，替换为**：

> 第四章提出基于目标驱动的地面目标轨迹预测方法TerraTNT。该方法将预测问题分解为目的地概率估计和条件轨迹生成两个子任务：首先通过目标分类器对候选终点进行概率评分，建模目的地选择的不确定性；然后采用层次化LSTM解码器，在给定终点条件下生成确定性的未来轨迹位移序列。在合成数据集上通过三阶段评估框架系统验证方法的有效性，并开展控制变量、消融和跨区域泛化实验。

---

## 修改3：第四章开头的方法概述

**找到第四章引言部分，确保包含以下定位说明**：

> 如第一章分析所述，长时域地面目标预测场景中，不确定性的主要来源是目的地选择而非轨迹形态。因此，本章提出的TerraTNT模型采用目标驱动的预测框架，将不确定性建模集中在目的地分类阶段。具体而言，模型包含四个核心模块：（1）CNN环境编码器，从18通道栅格地图中提取地形和地表覆盖特征；（2）双层LSTM历史编码器，捕捉目标的时序运动模式；（3）目标分类器，对K个候选终点进行概率评分（交叉熵损失训练），输出目的地概率分布P(g|H,E)；（4）层次化LSTM解码器，在给定终点条件下通过自回归方式生成60分钟的位移序列。
>
> 这一设计的核心思想是：不确定性通过目标分类器的softmax概率分布来表达，而轨迹生成则采用确定性解码，避免了长时域概率分布发散的问题。

---

## 修改4：第四章损失函数部分

**如果论文中提到了NLL损失或MDN损失，替换为**：

> 模型采用双任务联合损失函数进行端到端训练：
>
> L = L_traj + L_cls
>
> 其中，轨迹回归损失L_traj采用均方误差（MSE）度量预测位移序列与真实位移序列之间的差异：
>
> L_traj = (1/T) Σ_t ||Δp̂_t - Δp_t||²
>
> 目标分类损失L_cls采用交叉熵损失，训练目标分类器正确识别真实终点：
>
> L_cls = -log P(g* | H, E)
>
> 其中g*为真实终点在候选集中的索引。此外，训练过程中还引入了环境一致性损失L_env（惩罚穿越不可通行区域的预测轨迹）和waypoint监督损失L_wp（约束中间路径点的准确性）作为辅助正则化项。

---

## 修改5：第五章总结（已在PAPER_REVISION_PATCHES.md中）

**将"门控循环单元+混合密度网络+高斯混合模型"替换为**：

> 针对目标意图不确定性问题，设计了基于目标驱动的轨迹预测方法TerraTNT。该方法将不确定性建模集中在目的地选择阶段，通过目标分类器对候选终点进行概率评分，在给定终点条件下采用层次化LSTM解码器生成确定性的未来轨迹。这种设计避免了长时域概率分布发散的问题，同时保留了对目的地不确定性的建模能力。通过在合成数据集上的三阶段系统实验验证，证明了该方法的有效性和实用价值。

---

## 修改6：如果第一章表1.3后有"本文采用..."的总结行

**替换为**：

> 本文未直接采用上述轨迹级概率输出方法，而是借鉴TNT的目标驱动范式，将不确定性建模从轨迹空间转移到目的地空间。目标分类器输出的softmax概率分布P(g|H,E)即为本文对预测不确定性的显式表达，其优势在于：（1）目的地概率分布是定义在有限候选集上的离散分布，不存在长时域发散问题；（2）可通过调整候选终点集合的范围和密度，灵活控制不确定性建模的粒度；（3）概率最高的多个候选终点可自然地生成多条备选轨迹，满足实际应用中对多假设输出的需求。

---

## 逻辑链总结

```
第一章综述：不确定性建模方法（MDN/CVAE/GAN）在短时域有效
    ↓
第一章过渡（新增）：长时域场景下这些方法面临分布发散问题
    ↓
第一章过渡（新增）：目标驱动范式将不确定性集中在目的地选择阶段
    ↓
第四章方法：TerraTNT = 目标分类器(概率) + 确定性解码器
    ↓
第四章实验：三阶段评估框架验证不同先验条件下的性能
    ↓
第五章总结：准确描述实际方法
```

这条逻辑链是**完全自洽的**，而且有充分的文献支撑（TNT、PECNet都是这个路线）。
不需要"圆"，因为这本身就是一个合理的技术选择。

---

## 需要删除/修改的内容清单

以下是论文中需要搜索并修改的关键词/短语：

| 搜索关键词 | 操作 |
|-----------|------|
| 混合密度网络 / MDN | 仅保留在第一章综述中，第四/五章中删除 |
| 高斯混合模型 / GMM | 同上 |
| 概率分布（指轨迹输出时） | 改为"目的地概率分布"或"确定性轨迹" |
| 门控循环单元 / GRU | 改为"长短期记忆网络（LSTM）" |
| NLL损失 / 负对数似然 | 改为"交叉熵损失+MSE损失" |
| 输出...分布 | 改为"输出目的地概率评分和确定性位移序列" |
