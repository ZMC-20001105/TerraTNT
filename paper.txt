 目录

插图和附表清单 I

符号与缩略语表 III

摘要 V

Abstract VI

第1章 绪论 1

  1.1 研究背景与意义 1

  1.2 相关研究现状 2

  1.2.1 轨迹预测方法 2

  1.2.2 越野环境建模与路径规划方法 13

  1.2.3 研究现状小结 15

  1.3 研究目标与内容 16

  1.4 论文结构 17

第2章 多星协同对地观测系统与目标位置预测任务分析 19

  2.1 多星协同对地观测任务概述 19

  2.1.1 系统组成与基本框架 19

  2.1.2 卫星观测基本要素与任务筹划 20

  2.2 观测时间窗口约束 22

  2.2.1 卫星观测时间窗口定义 22

  2.2.2 多卫星观测时间序列 23

  2.3 环境约束 23

  2.3.1 环境约束的数学表示 24

  2.3.2 主要环境约束因素 24

  2.4 基于历史观测和环境约束的目标位置预测 24

  2.4.1 历史观测数据表示 25

  2.4.2 环境约束的整合 25

  2.4.3 预测不确定性表示 25

  2.4.4 预测区域确定 26

  2.5 本章小结 26

第3章 基于环境约束的轨迹生成方法 27

  3.1 环境数据预处理 28

  3.1.1 轨迹数据来源 29

  3.1.2 环境数据来源 30

  3.1.3 坐标系统与转换 31

  3.1.4 可通行域计算与连通性分析 31

  3.2 基于环境代价的路径规划 34

  3.2.1 问题定义与数学描述 34

  3.2.2 环境代价模型构建 34

  3.2.3 分层A*搜索算法 35

  3.2.4 目标点定义与场景设定 37

  3.3 基于路径关键点的轨迹生成 38

  3.3.1 路径平滑方法 40

  3.3.2 数据驱动的环境交互速度模型 41

  3.3.3 轨迹运动学约束 42

  3.4 轨迹生成方法的实验验证与分析 44

  3.4.1 K-fold交叉验证 44

  3.4.2 与人类驾驶员的对比验证 46

  3.4.3 SHAP特征重要性分析 47

  3.5 本章小结 48

第4章 基于意图感知的目标位置预测方法 50

  4.1 模型整体架构 50

  4.1.1 环境编码器 51

  4.1.2 历史轨迹编码器 53

  4.1.3 目标分类器 55

  4.1.4 轨迹生成器 56

  4.2 训练策略与损失函数 56

  4.2.1 双任务联合训练 56

  4.2.2 训练配置 57

  4.2.3 推理策略 58

  4.2.4 评价指标 58

  4.3 对比实验 59

  4.3.1 三阶段评估 59

  4.3.2 三阶段评估结果 59

  4.4 控制变量实验 69

  4.4.1 候选目标数量 70

  4.4.2 观测长度敏感性 70

  4.4.3 Waypoint数量影响 71

  4.5 消融实验 72

  4.5.1 组件消融实验 73

  4.5.2 特征消融实验 74

  4.6 跨区域泛化实验 74

  4.6.1 多区域数据集构建 75

  4.6.2 多区域独立训练实验 77

  4.6.3 跨区域泛化测试 79

  4.7 本章小结 82

第5章 总结与展望 85

  5.1 主要研究工作 85

  5.2 当前研究的不足 85

  5.3 未来研究展望 86

  5.4 本章小结 86

参考文献 87

致 谢 90

个人简历、在学期间完成的相关学术成果 91

插图和附表清单

图1.1 自行车运动学模型示意图^([3]) 3

图1.2 Frenet 坐标系下的轨迹表示^([4]) 3

图1.3 MLMM方法示意图^([7]) 4

图1.4 Qiao等提出的基于HMM的轨迹预测模型示意图^([9]) 5

图1.5 Schreier等提出的预测方法流程图^([12]) 5

图1.6 Alahi等提出的Social-LSTM方法概览^([15]) 7

图1.7 Giuliari等人对Transformer和LSTM的对比实验^([19]) 7

图1.8 Xin等提出的双LSTM网络结构图^([23]) 11

图1.9 Kucner^([31])提出的条件转移地图 13

图1.10 Rybansky合成地图的原理示意图^([19]) 14

图1.11 田洪清等提出的算法功能框架^([37]) 15

图2.1 多星协同对地观测系统示意图^([38]) 19

图2.2 基于信息融合的多星搜索动目标问题^([38]) 20

图2.3 观测时间窗口示意图^([38]) 22

图3.1 Bellmouth段轨迹采集区域情况^([40]) 29

图3.2 OORD数据集轨迹速度曲线 30

图3.3 分层规划结果示例图 37

符号与缩略语表

λ 经度

ϕ 纬度

h 高度

t 时间

Δt 时间间隔

r 卫星位置向量

v 速度向量

p 目标位置向量

s 目标状态向量

z 观测向量

w 过程噪声

R 协方差矩阵

θ 视场角/概率阈值

α 侧摆角度

W 地面幅宽

P 概率

C 环境约束函数

F 状态转移函数

𝒪 历史观测数据集

𝒲 观测时间窗口集

R_(pred) 预测区域

ŷ_(t) 时间步t的预测位置

y_(t) 时间步t的真实位置

T_(pred) 预测时间长度

p(y_(t) ∥ x_(t)) 预测分布的概率密度函数

N_(sat) 卫星数量

T_(obs)^(i) 第i颗卫星的有效观测时间

T_(total)^(i) 第i颗卫星的总时间

N_(target) 目标数量

T_(gap)^(j) 第j个目标的最大观测间隙

ADE 平均位移误差 (Average Displacement Error)

CE 校准误差 (Calibration Error)

CVAE 条件变分自编码器 (Conditional Variational Autoencoder)

DEM 数字高程模型 (Digital Elevation Model)

ECEF 地心地固坐标系 (Earth-Centered Earth-Fixed)

ECI 地心惯性坐标系 (Earth-Centered Inertial)

EKF 扩展卡尔曼滤波 (Extended Kalman Filter)

FDE 最终位移误差 (Final Displacement Error)

FOV 视场角 (Field of View)

GMM 高斯混合模型 (Gaussian Mixture Model)

GRU 门控循环单元 (Gated Recurrent Unit)

LSTM 长短期记忆网络 (Long Short-Term Memory)

MDN 混合密度网络 (Mixture Density Network)

NLL 负对数似然 (Negative Log-Likelihood)

OORD 越野障碍数据集 (Off-Road Obstacle Dataset)

RPC 有理多项式系数 (Rational Polynomial Coefficient)

UKF 无迹卡尔曼滤波 (Unscented Kalman Filter)

摘要

遥感卫星观测覆盖范围大，可以快速获取大面积区域信息，在侦察、目标追踪等领域有着重要应用价值。但是由于卫星过境时间和遥感载荷视场等限制，开展基于卫星星座的动目标跟踪观测时，可能出现目标观测的空窗期。为了尽量减小观测空窗期，提升对目标观测的连续性和观测时长，在进行卫星星座遥感任务规划时，如何有效预测目标在观测间隙期间的运动轨迹，并在下一观测窗口到来时准确估计其位置，是提升观测效率的关键问题。

本论文针对此问题，提出并实现了包含轨迹数据生成与环境感知预测的综合框架。首先，通过融合数字高程模型、地表覆盖数据和道路网络等多源地理信息，构建了精细化的环境通行成本地图，并结合战术意图驱动的分层路径规划算法生成符合环境约束的空间路径。其次，为将离散路径点转化为连续且符合物理规律的真实感轨迹，本文提出了一种数据驱动速度预测模型，该模型根据地形坡度、地表类型、路径曲率等20维环境和几何特征预测目标在不同路段的行驶速度，验证集R²达到0.815，从而生成包含完整时空信息的轨迹数据集，覆盖4种车辆类型和3种战术意图，共计10万余条60分钟轨迹。

为解决目标潜在目的地不确定性带来的长时域预测挑战，本文设计并实现了一种名为TerraTNT的目标驱动轨迹预测模型。该模型采用CNN环境编码器从18通道栅格地图中提取空间特征，采用双层LSTM编码历史轨迹的时序运动模式，通过目标分类器对候选终点进行概率评分，最后采用层次化LSTM解码器生成60分钟的未来轨迹。在模拟轨迹数据集上进行的大量实验验证表明，TerraTNT在已知目标场景下取得最优性能，平均位移误差（ADE）为1.23km，相比基线模型降低8.9%至74.5%；消融实验揭示环境编码器和LSTM解码器是关键组件；跨区域泛化实验表明地形复杂度是影响预测难度的主导因素。本文提出的方法能够为多卫星协同观测任务中的空窗期目标位置预测提供一种有效且可靠的解决方案。

关键词： 多星协同观测；轨迹预测；环境感知；目标驱动；深度学习

Abstract

Remote sensing satellites offer extensive observational coverage and
rapid acquisition of large-area information, playing a crucial role in
fields such as reconnaissance and target tracking. However, due to
limitations in satellite transit times and sensor fields of view,
observation gaps inevitably occur when monitoring moving ground targets
using satellite constellations. To minimize these gaps and enhance
observation continuity, effectively predicting target trajectories
during observation intervals and accurately estimating their positions
for the next observation window is key to improving observational
efficiency in satellite constellation remote sensing mission planning.

Addressing this issue, this thesis proposes and implements an integrated
framework encompassing trajectory data generation and environment-aware
prediction. Firstly, a refined environmental traversability cost map is
constructed by fusing multi-source geographic information, including
digital elevation models, land cover data, and road networks. A tactical
intent-driven hierarchical path planning algorithm is then employed to
generate spatial paths compliant with environmental constraints.
Secondly, to transform discrete path points into continuous and
physically plausible realistic trajectories, a data-driven speed
prediction model is proposed. This model predicts the target's traveling
speed on different path segments based on 20-dimensional environmental
and geometric features such as terrain slope, surface type, and path
curvature, achieving a coefficient of determination of 0.815 on the
validation set. This enables the generation of a trajectory dataset
containing complete spatiotemporal information, covering 4 vehicle types
and 3 tactical intents, totaling over 100,000 60-minute trajectories.

To tackle the long-term prediction challenges arising from target
destination uncertainty, an environment-aware trajectory prediction
model named TerraTNT is designed and implemented. This model employs a
convolutional neural network-based environment encoder to extract
spatial features from 18-channel raster maps, a dual-layer long
short-term memory network to encode temporal motion patterns from
historical trajectories, a target classifier for probabilistic scoring
of candidate endpoints, and a hierarchical long short-term memory
network decoder to generate 60-minute future trajectories. Extensive
experimental validation on simulated trajectory datasets demonstrates
that TerraTNT achieves optimal performance in known-target scenarios
with an average displacement error of 1.23 km, representing an 8.9% to
74.5% reduction compared to baseline models. Ablation experiments reveal
that the environment encoder and long short-term memory network decoder
are critical components, while cross-region generalization experiments
indicate that terrain complexity is the dominant factor affecting
prediction difficulty. The proposed method offers an effective and
reliable solution for predicting target positions during observation
gaps in multi-satellite collaborative observation tasks.

Keywords: Multi-Satellite Collaborative Observation; Trajectory
Prediction; Environment Awareness; Target-Driven; Deep Learning

绪论

研究背景与意义

随着科学技术的发展，现代战争的形态已经发生了根本性的改变，信息化、智能化的程度对于军队判断战争态势，作出正确部署具有重要意义。地面战场是最早出现的人类战场，虽然现代战争是地面、空中、海洋乃至太空的全面战争，但仍需要通过地面战场推进达到占领资源、控制人口等战争目的。

通过技术手段获取敌方目标位置等战场信息，可以帮助科学评估战场态势，进而做出更有利于获胜的决策部署。如伊拉克战争中联军通过侦察、通信卫星，对伊拉克实施全天候侦察监视。以地面部队为主力，在各种侦察与远程制导设备配合下快速推进，大大加快了战争进程。在近年来受到国际广泛关注的俄乌冲突中，双方投入和消耗的大量坦克也证明了现代战争中地面装甲车辆依然是战斗主力^([1])。然而相比于空中目标和海上目标，地面战场上的军事目标所处环境复杂，地形会极大地影响目标的速度和方向，增加了运动的复杂性。同时，由于地面目标可以利用地形地物进行隐蔽，例如藏匿于树林、山洞或建筑物中，雷达对地面目标的探测效果不如对空中和海上目标。这些特点都对地面战场中的敌方目标位置预测提出了挑战。相比于无人机、雷达等探测手段，成像卫星具有不受地理国界因素限制，侦查覆盖范围大等优势^([2])。虽然当前卫星存在资源较少，观测时间窗口较短等问题，不能满足对地球任意位置进行侦查的需求，但随着航天技术的发展，未来的太空卫星数量将会不断增长，卫星在军用观测领域将会发挥越来越重要的作用。

地面移动目标具有高度的机动性和不确定性，这为观测任务带来了挑战。由于轨道特性，卫星对地面目标一次观测的持续时间较短，多星接力观测时存在观测窗口和观测间隙。在观测窗口期，卫星可以直接获取目标的位置信息；而在观测间隙期间，目标的位置信息处于未知状态。为了保持对目标的持续跟踪，卫星任务规划时必须预测出观测间隙结束时目标的可能位置，以便后续卫星能够及时捕获目标。

位置预测的准确性直接关系到多星协同观测系统的效能。传统的位置预测方法主要基于线性推演或简单的动力学模型，难以应对复杂环境下目标的非线性运动模式。随着深度学习技术的发展，基于神经网络的预测方法展现出了处理复杂时序数据的强大能力，为地面移动目标位置预测提供了新的技术路径。然而，直接将现有的深度学习方法应用于多星协同观测场景仍面临诸多挑战。一方面，地面目标的运动受到地形结构的限制；另一方面，地面目标的行驶还受到驾驶员的意图影响，这些因素使得其运动模式更加复杂。

为解决上述挑战，预测算法需要能够考虑历史轨迹和环境约束，同时对目标未来位置进行多模态概率预测以有效估计目标意图，为卫星对地观测任务规划提供更可靠的决策依据。本研究旨在结合深度学习和地理信息技术，提出一种面向多星协同观测动目标任务的地面目标位置预测方法，为军事侦察和卫星任务规划提供技术支撑。

相关研究现状

轨迹预测方法

轨迹预测任务是基于历史观测与场景上下文信息，估计目标未来一段时间内的位置序列。同时在不同的应用场景下，需要结合任务特点考虑其他信息，比如行人轨迹预测需处理社交交互与避障行为，道路车辆受交通规则与车道约束，船舶轨迹则需考虑水文与航道因素。虽然这些场景下的目标运动各有特点，但是预测方法上可以大体分为基于物理模型、基于概率统计和基于深度学习的方法，本节将依次介绍这三类方法的相关工作。

1.2.2.1 基于物理模型的方法

物理模型方法是最早应用于轨迹预测的方法，主要基于目标运动学和动力学特性建立数学模型，如通过求解微分方程或状态空间方程来预测未来轨迹。这类方法物理意义非常明确，可解释性强。将目标看作质点可以基于一些基础的运动学模型，如匀速直线运动
(Constant Velocity, CV)、匀加速直线运动 (Constant Acceleration, CA)
和匀速转弯 (Constant Turn Rate, CT) 等模型，使用卡尔曼滤波(Kalman
Filter)等算法在目标短时间内行为稳定或观测频率足够高的情况下，能提供有效的短期预测。

质点模型忽视了目标本身的几何尺寸和形状等信息，在自动驾驶等场景需要更精细描述目标运动。自行车运动学模型
(Kinematic Bicycle Model)
能较好地反映车辆的非完整约束和转向特性，同时模型相对简单，因此被广泛应用于车辆路径规划和控制中。2017年，Polack等对该模型进行了深入分析，探讨了其在规划可行轨迹时的一致性和局限性^([3])。

[]

图1.1 自行车运动学模型示意图^([3])

为了更好地描述车辆在结构化道路环境（如高速公路、城市街道）中的运动，Werling^([4])等引入了基于
Frenet
坐标系的轨迹表示和生成方法。这种坐标系是沿着道路参考线定义的，可以将车辆运动分解为沿参考线的纵向运动和垂直于参考路径的横向运动，这种表示方式更便于结合道路几何信息。

[]

图1.2 Frenet 坐标系下的轨迹表示^([4])

当目标的运动模式发生变化时，单一固定的运动模型往往难以准确描述其行为，导致滤波精度下降。为了提升对不同机动行为的适应性，研究者提出了交互式多模型（IMM）算法^([5])。这种算法假设目标的运动可能符合多个预设的模型，通过并行运行多个滤波器，并根据观测数据估计每个模型的可能性，最终通过概率加权融合各个滤波器的输出。

2007年，Zhen等^([6])针对道路环境下的地面目标跟踪，提出一种利用道路信息改进的自适应变结构交互多模型估计，在变结构IMM算法基础上利用道路信息修正运动模型的状态转移矩阵和过程噪声协方差，并根据目标位置动态更新模型集。

2018年，Vashishtha和Panda^([7])提出最大似然多模型滤波（MLMM）方法，通过计算各个模型预测的测量值与实际测量值之间的残差，为每个模型估计似然值，选择具有最大似然值的模型进行状态估计。

[]

图1.3 MLMM方法示意图^([7])

尽管通过上述改进可以增强传统滤波方法的适应性，但运动模型的准确性决定了预测效果，对于行为复杂的目标难以建立有效的运动模型。同时，在长时间没有观测数据校正的情况下，模型的误差会随着时间不断累积，导致预测结果偏离实际轨迹。

1.2.2.2 基于概率统计的方法

相比于基于物理模型的方法在不确定性建模方面的局限。概率统计方法可以通过建立概率模型描述车辆运动的不确定性，主要包含隐马尔可夫模型（Hidden
Markov Model, HMM）、贝叶斯网络（Bayesian Network,
BN）、高斯过程（Gaussian Process, GP）等。

马尔可夫模型是一类基于状态转移的概率模型，其核心假设是系统的未来状态仅依赖于当前状态，而与历史状态无关。隐马尔可夫模型进一步引入了不可直接观测的隐状态，通过观测序列推断隐状态序列。

2008年，Berndt等^([8])将隐马尔可夫模型应用于驾驶员意图识别，通过将驾驶员的意图视为隐藏状态，而车辆的方向盘转角、油门、刹车踏板状态等等行为视为观测值建立HMM模型。这种方法在识别驾驶员意图的实验中预测准确率达到85%。HMM模型训练好之后参数是固定的，为了增强适应能力，2015年Qiao等^([9])提出一种自适应机制，可以根据最近的历史运动数据动态调整模型参数，提高预测精度。为了提升HMM对复杂场景的适应能力，2018年Deng和Söffker^([10])提出了一种结合模糊逻辑和隐马尔可夫模型的驾驶行为预测方法。通过引入模糊逻辑处理输入特征，可以更好地建模驾驶状态的不确定性。

[]

图1.4 Qiao等提出的基于HMM的轨迹预测模型示意图^([9])

贝叶斯网络是一种基于概率图模型的表示方法，通过有向无环图结构描述变量间的条件依赖关系。在轨迹预测领域，贝叶斯网络能够有效融合多源信息，构建车辆行为与环境因素之间的概率依赖模型。

在道路交叉口等场景下，环境的约束可以帮助判断车辆的意图，2011年，Lefèvre^([11])等提出了一种基于贝叶斯网络的车辆意图预测方法，将地图信息整合到贝叶斯网络模型中，通过建立驾驶员意图、车辆行为和地图之间的概率依赖关系，推断各种意图的概率。在通用道路环境下，2016年Schreier等^([12])提出了一种基于贝叶斯方法的机动意图预测和轨迹估计方法，该方法在任意道路环境中都能有效工作，既能推断出各种机动意图，又可以根据各种机动意图及其概率生成多条可能的未来轨迹。

[]

图1.5 Schreier等提出的预测方法流程图^([12])

高斯过程是一种非参数化的概率模型，通过定义随机变量之间的协方差函数来描述数据分布。在轨迹预测领域，高斯过程回归能够基于历史观测数据学习车辆运动的内在模式，并对未来位置进行概率预测。

2014年，Wiest等^([13])开发了一种基于高斯过程回归的轨迹预测模型，该模型利用切比雪夫多项式来近似表示车辆过去和未来轨迹的如速度、偏航角等特征，得到统一的特征向量。使用大量观测到的历史-未来轨迹对训练一个联合概率分布作为运动模型，并且用高斯混合模型建模概率分布。在复杂交通场景中，该方法的预测准确度比传统卡尔曼滤波提高约20%。2019年Guo^([14])等提出了一种基于高斯随机场的多车辆交互建模方法，完全用数据驱动，将每种运动模式建模成一个高斯过程，这个高斯过程可以定义车辆位置到速度的速度场，结合狄利克雷过程可以对交通数据帧进行聚类，提取出交互模式。

1.2.2.3 基于深度学习的方法

概率统计方法虽然可以进行不确定性建模，但往往需人工设计特征与模型结构，难以自动捕捉复杂空间-时间关系。近年来，随着深度学习技术的快速发展，基于神经网络的轨迹预测方法成为研究热点，这类方法能够从大规模数据中自动学习复杂的非线性时空特征，无需人工设计特征，提供了更高的预测精度和更强的泛化能力。与前两类方法相比，在有大量训练数据的场景下，深度学习方法在处理高维数据和捕捉复杂模式方面具有显著优势。接下来介绍深度学习方法在时序建模、环境交互建模、不确定性表示与长时域预测策略等方面的研究进展与关键技术。

(一) 时序建模

在时序建模方面，循环神经网络（Recurrent Neural Network,
RNN）及其变种长短期记忆网络（Long Short-Term Memory,
LSTM）和门控循环单元（Gated Recurrent Unit,
GRU）通过内部的循环结构和门控机制，能够学习和记忆序列数据中的长期依赖关系，擅长处理具有时序特性的数据。

2016年，Alahi^([15])等首次将长短期记忆网络应用于行人轨迹预测，通过为场景中的每个人设计一个LSTM网络，并使用池化层共享相邻行人的隐藏状态，使得模型可以学习行人间的交互行为。2017年，Wang^([16])等^([16])针对时空序列预测提出了PredRNN，该网络引入时空LSTM单元，包含标准时间记忆和时空记忆两个核心，在网络中可以进行同层级的时间信息传递和跨层级的时空传递，能更好地捕捉时空细节与动态。

[]

图1.6 Alahi等提出的Social-LSTM方法概览^([15])

2019年，Dai等^([17])改进了LSTM模型，专注于目标车辆受到临近车辆交互影响下的轨迹预测问题。该方法先独立预测各车辆的轨迹，然后通过使用交互LSTM修正初步预测的结果得到最终预测结果，并且引入一种在堆叠LSTM层之间的连接，降低模型训练难度，同时有着更高的预测精度。

RNN及其变种方法有循环结构难以并行、处理长序列效率较低、梯度反向传播易消失或爆炸等局限。Transformer架构凭借自注意力机制能够处理长距离依赖关系，在序列建模任务中取得了出色的表现，近年来也被引入轨迹预测领域。2020年，Giuliari等^([19])探索了使用Transformer网络进行轨迹预测，测试结果表明简单的Transformer模型在TrajNet数据集中取得了比LSTM更好的性能，证明了该架构解决轨迹预测任务的有效性。

[]

图1.7 Giuliari等人对Transformer和LSTM的对比实验^([19])

表1-1 时序建模方法对比

  -------------------------------------------------------------------------------------------------------------------------------------
  方法类型          代表方法        核心机制       主要优势                                       主要局限性                         
  ----------------- --------------- -------------- ---------------------------------------------- ---------------------------------- --
  RNN及其变种       LSTM, GRU， RNN 循环连接       能有效缓解梯度消失问题，适合中等长度序列建模   串行计算效率低，难以并行训练       

  Transformer结构   Transformer，   自注意力机制   并行计算效率高，全局依赖建模能力强             计算复杂度为高超长序列计算开销大   
                    AgentFormer，                                                                                                    
                    Wayformer                                                                                                        
  -------------------------------------------------------------------------------------------------------------------------------------

(二) 环境交互建模

除时序建模外，许多轨迹预测场景需要有效表达智能体间以及智能体与环境间的空间交互关系。根据场景数据的表示方式不同，可以分为栅格化表示、矢量化表示和图结构表示。

栅格化表示是将场景离散化为网格单元，每个单元存储语义或几何信息，适合处理影像等数据，通常采用卷积神经网络（Convolutional
Neural Network，
CNN）提取特征。Mangalam等(2020)提出Y-Net，采用编码器-解码器架构处理栅格化的场景语义地图，通过CNN提取环境特征并与历史轨迹编码融合，先预测终点位置的概率热力图，再生成中间路径点，最后解码完整轨迹，实现了对行人长期轨迹的预测。Salzmann等(2020)提出Trajectron++，采用（Conditional
Variational Auto-Encoder,
CVAE）框架，将栅格化的地图表示与动态障碍物信息编码为场景上下文，通过潜在变量采样生成多模态轨迹，在多个基准数据集上取得了优异的多模态预测性能。

矢量化表示是将地图元素表示为几何向量序列，可以保留精确的几何信息。Gao等(2020)提出VectorNet，将地图元素(车道线、停止线)表示为polyline向量序列，并通过分层图神经网络先聚合局部特征再进行全局交互，相比栅格表示更紧凑。Zhao等(2020)提出TNT(Target-driven
Trajectory
Prediction)，采用目标驱动策略，首先根据矢量化地图预测可能的终点位置，再针对每个终点生成对应轨迹，实现了多模态预测。Liang等(2020)提出LaneGCN，构建车道图并定义多种邻接关系，通过扩展图卷积在车道网络上传播信息，实现双向交互建模，使模型能同时理解车辆意图与车道拓扑约束。

图结构表示将智能体与场景元素构建为图，通过图神经网络（Graph Neural
Network,
GNN）建模交互关系。在交通场景中，车辆、行人和环境元素之间存在复杂的空间关系和交互影响，这些关系可以自然地表示为图结构。2018年，Yu等^([18])针对交通预测，提出了时空图卷积网络（STGCN），用图卷积来聚合相邻节点信息捕捉空间依赖性，用时间卷积捕捉时间依赖性。相比RNN方法，STGCN训练速度快、参数少，能有效捕捉时空相关性。

表1-2 环境建模方法对比

  -------------------------------------------------------------------------------------------------------------------------
  表示方法     代表方法       场景编码方式                 常用结构       主要优势                                       
  ------------ -------------- ---------------------------- -------------- ---------------------------------------------- --
  栅格化表示   YNet，         占用栅格或语义地图           卷积神经网络   适合处理栅格化的地理数据，能直接融合遥感影像   
               Trajectron++                                                                                              

  矢量化表示   VectorNet，    车道线与路网元素的向量序列   图神经网络     保留几何精度，表示紧凑，计算效率高             
               TNT                                                                                                       

  图结构表示   LaneGCN，      智能体与场景元素构成的图     图神经网络     能有效建模拓扑关系与交互模式                   
               Social-BiGAT                                                                                              
  -------------------------------------------------------------------------------------------------------------------------

(三) 不确定性表示与概率建模

在观测到真实位置之前未来存在多种可能的演化路径，因此相比于绝对位置，概率建模对下游决策任务具有更大意义。参数化方法方面，混合密度网络(Mixture
Density Network，
MDN)通过神经网络预测分布参数(均值μ_(k)、方差σ_(k)、混合系数π_(k))，用分布参数描述未来概率分布。Bishop(1994)最早将MDN应用于回归任务，通过最大化对数似然训练网络输出混合高斯分布，后被广泛用于轨迹预测的多模态输出，其优势在于推理速度快且能够直接计算概率密度值。

条件变分自编码器(Conditional Variational Autoencoder，
CVAE)提供了另一种生成多模态轨迹的途径，通过潜在变量z的采样生成多样化轨迹，其训练基于证据下界(Evidence
Lower Bound，
ELBO)目标函数相对稳定。Ivanovic和Pavone(2019)提出的Trajectron将CVAE与动态时空图结合，实现了多智能体轨迹的联合概率建模，编码器将历史轨迹与场景上下文编码为潜在变量的后验分布，解码器则以采样的潜在变量为条件生成未来轨迹，通过多次采样可获得丰富的多模态预测。在此基础上，Salzmann等(2020)进一步提出Trajectron++，引入动力学约束与地图编码，提升了预测的物理合理性。

生成对抗网络(Generative Adversarial
Network，GAN)提供了另一种学习数据分布的思路，通过生成器与判别器的对抗训练可生成逼真的轨迹样本。Gupta等(2018)提出Social-GAN，将社交池化机制与GAN结合用于行人轨迹预测，但训练过程易出现模式崩溃(mode
collapse)问题，导致生成的轨迹多样性不足。

近年来兴起的扩散模型(Diffusion
Model)通过逐步去噪过程生成高质量样本，在图像生成领域取得突破后开始被引入轨迹预测。Gu等(2022)提出MID(Motion
Diffusion)，借鉴DDPM(Denoising Diffusion Probabilistic
Model)的思想，通过前向扩散过程逐步向轨迹添加高斯噪声直至完全破坏原始信号，再通过反向去噪过程从纯噪声逐步恢复出预测轨迹，每一步去噪由神经网络预测噪声项并减去。尽管推理速度较慢，但生成质量优异，在Argoverse数据集上取得了最佳的多模态预测性能，证明了扩散模型在轨迹预测中的潜力。

表1-3 概率输出方法对比

  ---------------------------------------------------------------------------------------------------------------------------------
  方法类型           概率表示形式                 主要优势                               主要局限性
  ------------------ ---------------------------- -------------------------------------- ------------------------------------------
  混合密度网络       参数化的混合高斯分布         解析采样效率高，推理速度快，训练稳定   表达能力受混合成分数量限制

  条件变分自编码器   通过潜在变量生成的隐式分布   训练稳定，能生成多样化样本             需多次采样后进行核密度估计，推理效率中等

  生成对抗网络       隐式学习的数据分布           采样速度快，生成样本逼真               训练不稳定，易出现模式崩溃问题

  扩散模型           通过逐步去噪生成的分布       生成质量高，训练稳定                   推理需多步迭代，计算开销极大

  热力图方法         离散化网格的概率分布         直观易理解，训练稳定                   空间分辨率受限，高分辨率时内存开销大
  ---------------------------------------------------------------------------------------------------------------------------------

(四) 长时域预测策略

前文对序列建模架构、环境交互表示方法进行了介绍，对于更长时间的预测任务还需要相应的预测策略。基于意图的预测方法核心思想是利用对移动目标未来目标或行为意图的预测来指导或约束轨迹的生成。通过引入更高层级的语义信息，可以有效处理轨迹的多模态性，提高长期预测的准确性和预测结果的可解释性。近

意图识别驱动方法聚焦于理解和预测交通参与者的离散行为意图，如直行、左转、变道、过马路等，并将识别出的意图作为轨迹预测的前提或重要输入。2017年，Zhao^([21])等基于环岛场景数据研究了驾驶员行为建模，仅使用方向盘转角和角速度信息就实现了对驾驶员是停留还是驶离行为的预测。

2017年，Zyner^([22])等将LSTM应用于驾驶意图预测，通过分析车辆在十字路口的历史轨迹，预测驾驶员可能的转向意图。实验表明，该方法在无信号灯十字路口场景下，意图预测准确率达到89%，不过没有进一步根据意图生成轨迹。

2018年，Xin^([23])等提出一种基于双LSTM网络的意图感知车辆轨迹预测算法。该方法的创新之处在于使用第一个LSTM识别驾驶意图，然后将意图信息与历史轨迹一起输入第二个LSTM预测车辆未来的横向偏差和纵向加速度，在5秒的预测时域内预测精度优于其他的基于LSTM的方法。同年，Goldhammer^([24])等使用机器学习的方法对道路上的行人和骑行者进行意图检测和预测，在运动状态分类和轨迹预测等任务中显著优于卡尔曼滤波等基准方法。

[]

图1.8 Xin等提出的双LSTM网络结构图^([23])

2020年，Wu^([25])等使用LSTM把行人的行为分类成站立、行走和跑步，将行为识别的概率和环境交互特征输入动态贝叶斯网络，判断行人是否有穿越马路的意图，将意图识别结果和行为识别结果输入基于粒子滤波的轨迹预测模型，提高了预测的准确性和可解释性。

相比离散的意图分类，目标条件驱动的预测方法通常采用分层策略，首先预测目标的连续终点或关键路径点，然后以此为条件生成完整轨迹。这种方法特别适合处理长期预测问题，并能自然地生成多模态轨迹。

2018年，Muhammad^([26])等将之前已经观测到的同类目标的轨迹视为参考轨迹，将空间离散化成栅格，对每个栅格计算参考轨迹穿过该单元时的速度、航向角度等属性特征，形成一个查找表。在估计被观测目标的意图时使用粒子滤波的方法，用一群粒子代表不同意图的概率分布，通过统计不同意图的粒子权重总和就可以知道目标属于各种意图的概率。2020年，Mangalam^([27])等认为人类轨迹预测具有多模态性，并且提出人类轨迹的不确定性来自于两个方面，一是行人自己知道但是模型不知道的因素，也就是行人长期的目标或者说目的地。二是行人自己也不知道的因素，也就是达到目标的路径。对于这两部分模分开进行建模，模型包括三个子网络，一个子网络用来预测终点和关键路径点的概率热力图，另一个子网络在给定终点和关键路径点的情况下，预测所有中间点的概率热力图。通过这种方式使得预测的有效时长扩展到了一分钟。

2022年，Xu^([29])等提出了一种基于回顾性记忆的轨迹预测方法，模仿了神经心理学中的回溯记忆机制，核心是通过显式地存储过去的轨迹特征和对应的未来意图特征，在预测时调用最相似的情况来预测未来的意图。整个过程分为两步，首先预测智能体的未来意图，也就是终点的位置，然后使用一个单独的轨迹填充网络，根据意图生成完成的未来轨迹。

表1-4 长时域策略对比

  ---------------------------------------------------------------------------------------------------------------------------------------------------------------
  策略类型       代表方法         核心思想                                 优势                                             局限                               
  -------------- ---------------- ---------------------------------------- ------------------------------------------------ ---------------------------------- --
  终点驱动方法   TNT， PECNet，   分层建模，先预测终点再生成轨迹           通过分层策略降低建模复杂度，自然产生多模态预测   依赖合理的终点候选集生成方法       
                 Y-net                                                                                                                                         

  知识蒸馏方法   Di-Long          用短期预测教师网络指导长期预测学生网络   能稳定长期预测的训练过程                         需要额外的教师模型，训练流程复杂   

  连续时间建模   Neural CDEs      将轨迹建模为连续时间微分方程             能处理不规则时间采样，理论优雅                   求解微分方程计算开销大             

  物理约束融合   深度卡尔曼滤波   将物理模型先验融入深度学习框架           提升预测的物理合理性与鲁棒性                     需要准确的动力学模型               
  ---------------------------------------------------------------------------------------------------------------------------------------------------------------

越野环境建模与路径规划方法

与结构化的道路交通环境显著不同，越野环境下的目标运动受到地形地貌、植被覆盖、土壤类型、天气状况等多种复杂且连续变化的因素影响。因此，准确预测越野目标的运动需要合理建模环境因素，帮助理解目标可能的移动范围和行为模式。越野环境建模的核心在于量化不同区域对于特定移动目标的通行难度或成本，这主要应用在野外环境的路径规划问题上，虽然不直接和轨迹预测相关，但是了解目标的规划方法对我们预测其位置也具有帮助。

2013年，Kucner^([31])等提出了一种条件转移地图方法，这种方法基于栅格单元，每个单元中存储的是转移概率。如果物体从单元
D 进入中心单元，地图会存储它向A、B、C、E、F、G、H各个方向离开的概率。

[]

图1.9 Kucner^([31])提出的条件转移地图

2013年，Hohmann^([32])等开发了一种基于GIS的车辆移动性评估方法，通过为每一种地理因素在每个栅格单元赋值一个减速系数，并综合所有地理因素的减速系数计算出栅格的最终通行速度。最终得到一张越野通行能力图，其中每个栅格的值代表特定车辆在该栅格处的可达速度。2015年，Rybansky^([33])等对军用和救援车辆进行了实地测试，对植被、水文、土壤条件、坡度等对速度的影响进行了分析，比如通过车辆的牵引力曲线图来确定车辆在不同坡度下的行驶速度，比较车辆的技术参数和水道的水文参数来确定水域通行能力及相应的减速系数等。并提出基于栅格地图的越野车辆移动性建模方法。该方法为影响车辆速度的多种地理因素定义减速系数，并相乘得到每个栅格单元的总减速系数，形成通行成本地图。

[]

图1.10 Rybansky合成地图的原理示意图^([19])

有了环境成本的量化表征，路径规划算法可进一步综合多种因素寻找最优或可行路径。越野环境下的路径规划需要考虑地形、障碍物、威胁等多种因素，研究者提出了多种适应越野环境的规划算法：

2016年，赵芊^([34])等研究了基于GIS的全地形车路径规划，通过综合地理因素得到可以反映可通行性的通过率栅格模型，然后从通过率栅格模型中提取并生成一个矢量化的路网地图，并使用多种路径规划算法规划最优行驶路径。

2023年，Ahn^([35])等针对无人战车规避敌方的场景，提出了基于DLite的启发式算法。该方法扩展了DLite的代价函数，综合考虑了移动距离、地形和坡度以及敌方威胁，能够在动态环境中高效地规划安全路径。

2024年，Zhang^([36])等提出一种基于深度强化学习的越野环境分层路径规划方法。该方法在高层使用改进的D*Lite算法生成考虑地形成本的全局路径点。低层在全局路径点的引导下，使用动态窗口法（DWA）进行局部路径规划和避障，并设计了奖励函数，利用深度强化学习实现了DWA参数的自适应优化，适应动态变化的越野环境。

2024年，田洪清^([37])等提出一种基于势场搜索树的智能车辆越野路径规划方法。该方法首先使用势场模型量化评价越野环境中的驾驶风险，然后利用该风险势场引导RRT算法的采样和扩展过程，使其优先探索低风险区域，高效地找到风险较低的初始路径，再进行路径优化。

[]

图1.11 田洪清等提出的算法功能框架^([37])

综上所述，越野环境建模与路径规划方法通过将地形、植被、土壤等物理因素转化为可计算的通行成本或速度约束，为理解目标在复杂非结构化环境中的移动规律奠定了基础，这些方法揭示了环境因素如何影响目标的可达区域与运动偏好，为本文所关注的越野目标轨迹数据集制作提供了思路。

研究现状小结

在前文中我们以预测方法为主线，梳理了基于物理模型、基于概率统计、基于深度学习方法及各方法的子类别的研究思路和适用场景。对于本文任务，多星协同观测场景下的越野地面目标长期位置预测，在时域尺度、环境复杂度等维度与现有研究存在较大差异。

在时域尺度方面，任务需要能处理在两次观测之间的可能的时间窗长度，因此要求在60分钟甚至更长时域内预测位置概率分布。这远超现有场景的典型范围。多数研究在3-10秒内评估性能，少数长期预测工作也仅达1分钟量级。当预测时域从秒级扩展到小时级，不确定性累积呈指数增长，虽然对目标轨迹的预测精度要求较低，不超过观测卫星视场范围即可。但目标可达区域从局部邻域扩展至数公里乃至数十公里广域，单纯依靠历史轨迹惯性外推已无法提供有效约束。此时，长期意图(如前往战略要地、规避威胁区域)成为主导轨迹演化的关键因素。

环境复杂度挑战：越野环境对运动的影响机制与道路环境存在区别。道路约束主要体现为车道边界、交通规则等显式几何与语义信息，具有明确可行域边界，易于通过栅格掩码、矢量多边形或图节点离散化表示，并通过CNN、GNN等结构化模型提取特征。越野环境约束则连续且多因素耦合：陡峭坡度降低速度但不一定禁止通行，茂密植被可能对车辆通行也有限制。这些因素的影响不仅取决于地理属性本身，还与车辆类型等因素相关。

鉴于上述局限性与技术挑战，本文聚焦多星协同观测场景下的越野地面目标长期位置预测问题，在以下层面提供解决方案。

预测策略：采用基于终点或意图的分层预测框架。通过显式推断目标可能的长期意图，也就是终点位置概率分布。与现有终点驱动方法不同，本文将结合越野环境可达性分析与历史行为模式，给出候选终点集合并测试候选终点集合分布对预测的影响，避免对车道拓扑或预定义兴趣点的依赖。同时，通过混合密度网络这一参数化方法表达每个时间步位置的不确定性。

环境建模：在轨迹数据集制作阶段融合遥感数据，数字高程模型DEM、土地覆盖LULC、开放路网数据提取多维地理特征，结合越野环境评估方法建立地形-速度映射关系，生成栅格化的通行性与速度约束地图。在深度学习模型中，通过卷积神经网络提取环境空间结构特征，并通过注意力机制与历史轨迹特征交互，使模型能权衡历史惯性与环境约束对未来轨迹的影响。

研究目标与内容

本研究针对多卫星协同观测环境下的地面目标轨迹与位置预测问题，围绕前述不足与挑战，主要开展以下三方面研究工作。

第一，基于环境约束的轨迹生成方法。分析真实越野环境下的环境特性与轨迹运动特性关系。由于军事侦察场景难以获取大规模真实标注数据，本研究利用公开地理信息数据(数字高程模型、土地覆盖物类型数据、开放街道地图等)，结合车辆动力学模型与地形-速度映射关系，生成物理一致的合成轨迹数据集。通过设定不同地形、不同意图模式组合的多种任务场景，构建训练与测试数据集，为后续模型开发与评估提供数据支持。

第二，融合环境约束与历史轨迹的深度学习预测模型。一方面通过LSTM时序建模模块捕捉历史轨迹动态特征与长期依赖，另一方面基于CNN提取地形、地表覆盖物、道路网络等环境栅格地图信息。通过特征融合与注意力机制，使模型能在预测过程中自适应权衡历史惯性与环境约束，提升长期预测的效果。

第三，基于意图感知的目标位置概率预测方法。针对长时域预测中终点的重要引导作用，研究基于历史行为模式与环境分析的目的地推理算法，为潜在多个可能终点赋予相应概率。

论文结构

[]

本论文分五章，各章节内容安排如下：

第一章介绍研究背景与意义，综述轨迹预测和目的地预测研究现状，分析现有研究中的挑战和不足，提出本研究的主要研究目标和研究内容。

第二章进行问题分析与数学描述，对多星协同观测动目标任务中的目标位置预测问题进行数学建模与描述，分析问题特点和技术难点。

第三章介绍轨迹数据生成方法，利用开源越野环境下的车辆运动数据集，研究基于地理信息数据的环境约束建模方法，构建包含地形、地表覆盖等因素的综合环境约束模型，并生成多种场景下的轨迹数据集，为轨迹预测任务提供数据集支持。

第四章介绍目标位置预测方法，通过提取目标的运动学特征和环境上下文信息得到基础特征，结合潜在目的地的相对向量，预测目标下一次观测时的概率分布。并在在合成数据集上对比多种基线方法效果，结合航天侦查任务特点设计候选终点集合实验，验证所提方法的有效性，评估性能优势和应用价值。

第五章总结与展望，总结研究成果，分析研究局限性，提出未来研究方向和改进措施。

多星协同对地观测系统与目标位置预测任务分析

多星协同对地观测系统是由多颗卫星组成的一个协同工作的观测网络，通过合理分配观测资源，实现对地面目标的连续监视与追踪。与单星观测相比，多星协同观测具有时空覆盖范围广、观测频率高和信息互补性强等优势。本章将对多星协同对地观测任务的基本框架、工作原理进行介绍，介绍这一任务背景下进行目标位置预测的数学模型。

多星协同对地观测任务概述

系统组成与基本框架

多星协同对地观测系统主要由空间段、地面段和用户段三部分组成。空间段包括多颗配备光学或雷达成像设备的观测卫星；地面段包括数据接收站、任务规划与控制中心；用户段则负责数据分析与应用。系统运行过程可分为任务规划、观测数据获取、数据处理与融合、目标状态估计与预测等环节。

[]

图2.1 多星协同对地观测系统示意图^([38])

本研究主要考虑光学成像传感器，其工作原理是利用目标反射的太阳光进行成像。卫星观测范围受传感器视场角限制，同时还受到太阳高度角、星下点位置等因素影响。

对于第k颗卫星，其在时刻t的观测覆盖区域可表示为地球表面上的一个多边形区域A_(k)(t)，地面目标的位置和速度分别为p(t)和v(t)。当地面目标位于该区域内时，才能被卫星观测到。卫星对目标的观测模型可表示为：

z_(k)(t) = h_(k)(p(t), t) + v_(k)(t) (2-1)

其中z_(k)(t)为卫星k在时刻t的观测值，h_(k)(⋅)为观测函数，将目标状态映射为观测量，v_(k)(t)为观测噪声，通常假设为均值为零的高斯白噪声，协方差矩阵为R_(k)(t)。

在卫星对地观测中，将图像坐标系中的目标位置转换为地理坐标系中的实际位置是目标定位的关键环节。这一过程可以通过刚性轨道模型和共线方程模型等方法，估计目标的运动信息。2023年，武汉大学的汪韬阳^([39])等利用吉林一号光学视频卫星开展星海同步观测试验。并在稀疏控制条件下实现了舰船目标几何定位精度为1.60
m，速度估计精度为0.18
m/s,方向估计精度为4.05°。这样的定位算法精度已经满足我们预测任务的精度需求，因此本文不讨论如何具体处理图像，从中提取预测任务所需要的目标运动学信息，而是设定任务的输入是经过算法提取后的目标位置、速度、加速度、航向信息。

卫星观测基本要素与任务筹划

卫星对地观测任务涉及多种关键参数和概念，这些因素直接影响多星协同系统的观测规划和执行效果。理解这些基本要素对于构建有效的多星协同观测体系至关重要。

[]

图2.2 基于信息融合的多星搜索动目标问题^([38])

星下点是卫星与地球中心连线在地球表面的投影点，代表卫星在地球表面的瞬时位置。卫星的星下点轨迹随时间按一定规律在南北纬度之间移动，形成特定的覆盖带。星下点轨迹的预测是多星协同观测任务筹划的基础，通过精确计算多颗卫星的星下点轨迹，可以确定每颗卫星的可观测区域及最佳观测时机。

视场角是卫星传感器能够同时观测到的角度范围，通常用度或弧度表示。对于光学卫星，视场角与传感器大小和焦距直接相关，决定了单次观测的地面覆盖范围或称幅宽。典型的光学遥感卫星视场角在2°至15°之间，对应的地面幅宽从几公里到数百公里不等。幅宽的计算公式为：

W = 2 ⋅ h ⋅ tan(θ/2) (2-2)

其中W为地面幅宽，h为卫星高度，θ为视场角。

侧摆角度是卫星传感器光轴与垂直于地球表面的线之间的夹角，表示卫星成像的倾斜程度。现代遥感卫星通常具备较大的侧摆能力，这极大地提高了对特定目标的重访频率。较大的侧摆角虽然扩展了卫星的观测范围，但也会导致地面分辨率下降和几何畸变增加。侧摆对地面分辨率的影响可表示为：

$r_{off} = \frac{r_{nadir}}{\cos(\alpha)}$ (2-3)

其中r_(off)为侧摆条件下的地面分辨率，r_(nadir)为垂直观测时的分辨率，α为侧摆角度。

观测条带是卫星沿轨道移动时形成的连续观测区域。对于动目标跟踪，常采用条带式成像模式，即卫星传感器持续指向目标，随卫星轨道的移动形成一条观测带，这种模式对传感器的姿态控制和稳定性要求较高。

在多星协同对动目标观测任务中，上述参数共同决定了每颗卫星的观测能力和约束条件。通过优化卫星的侧摆角度和观测模式，可以最大限度地提高对动目标的观测效率。例如，当目标位于一颗卫星观测范围的边缘区域时，可通过调整侧摆角度延长观测时间；当多颗卫星同时可见目标时，可采用不同侧摆角度实现多角度立体观测。

多星协同观测任务筹划需要综合考虑各卫星的轨道参数、视场角、侧摆能力以及目标特性，构建时空优化模型。首先确定目标所在区域可能的观测时间窗口，然后根据每颗卫星的特性分配具体任务，包括观测时间、侧摆角度、成像模式等。针对动目标，还需考虑目标运动特性，预测目标在各时间窗口内的可能位置，以确保有效观测。在第2.2节中，我们将进一步详细讨论多星观测时间窗口约束及其数学描述。

观测时间窗口约束

在多星协同对地观测系统中，由于卫星轨道特性和地球自转，每颗卫星对特定区域的观测存在时间窗口约束，这是系统运行的基本约束条件。本节将详细阐述时间窗口约束的数学描述及其对系统运行的影响。

卫星观测时间窗口定义

对于第k颗卫星，其对目标区域的观测时间窗口可定义为一个时间区间：

W_(k) = [t_(k, start), t_(k, end)] (2-4)

其中，t_(k, start)和t_(k, end)分别表示卫星k开始和结束观测目标区域的时刻。时间窗口长度Δt_(k) = t_(k, end) − t_(k, start)通常受卫星轨道参数、传感器视场角及目标区域大小的影响。观测时间窗口的计算需要综合考虑卫星轨道预报、传感器参数以及地球表面地形特征。对于给定的目标区域，利用卫星轨道力学模型可以预测卫星何时经过该区域上空或何时能够通过侧摆观测到该区域。

[]

图2.3 观测时间窗口示意图^([38])

对于给定目标区域R，卫星k的观测时间窗口需满足以下条件：

∀t ∈ W_(k), R ∩ A_(k)(t) ≠ ⌀ (2-5)

即在整个时间窗口内，目标区域与卫星观测覆盖区域有交集。对于动目标观测，这一条件需要进一步考虑目标的运动状态，确保目标在观测窗口内始终位于卫星的可观测范围内。这要求卫星具备足够的敏捷性，能够根据目标运动调整观测角度和范围。

在实际应用中，考虑到卫星姿态调整时间、图像拍摄与传输时间，有效观测时间窗口通常短于理论窗口：

W_(k)^(effective) = [t_(k, start) + δt_(prep), t_(k, end) − δt_(end)]
(2-6)

其中δt_(prep)和δt_(end)分别表示窗口开始和结束时的调整时间。姿态调整时间与卫星的敏捷性密切相关，现代敏捷卫星可在几秒内完成大角度姿态调整。

多卫星观测时间序列

对于由N颗卫星组成的观测系统，所有可能的观测时间窗口构成一个时间序列：

𝒲 = {W₁, W₂, ..., W_(N)} (2-7)

将这些时间窗口按开始时间排序，得到一个观测序列：

t_(1, start), t_(2, start)...t_(N, start) (2-8)

由于不同卫星轨道特性的差异，观测时间窗口之间可能存在重叠或间隔，这直接影响系统对目标的连续观测能力。定义相邻观测窗口的间隔为：

ΔT_(i) = t_(i + 1, start) − t_(i, end) (2-9)

当ΔT_(i) > 0时，表示存在观测间隙；当ΔT_(i) ≤ 0时，表示观测窗口重叠，可进行连续观测。由于在间隙期间目标状态持续变化，且缺乏直接观测数据，需要通过合理设计星座构型和观测策略，最大限度地减少观测间隙，提高目标跟踪的连续性。

针对动目标观测，还需要考虑窗口内目标运动与卫星观测能力的匹配问题。定义卫星k在观测窗口W_(k)内对运动目标的有效观测概率为：

$P_{k}^{effective} = \frac{1}{\Delta t_{k}}\int_{t_{k,start}}^{t_{k,end}}\mathbb{I}\left( v_{target}(t) \leq v_{k,\max}(t) \right)dt$
(2-10)

其中v_(target)(t)为目标在时刻t的表观运动速度，v_(k, max)(t)为卫星k在时刻t的最大可跟踪速度，𝕀(⋅)为示性函数。这一概率度量了卫星在整个观测窗口内成功捕获并跟踪目标的能力。

在多星协同观测系统中，关键挑战之一是如何在各卫星观测窗口之间的间隙期间，准确预测目标位置，为任务规划分配合理的接续观测卫星平台，实现高效的观测任务交接和快速重捕获目标奠定基础。这就需要建立目标运动模型和考虑环境约束进行位置预测。

环境约束

环境约束是影响地面目标运动的重要因素，合理的环境约束模型可以显著提高目标位置预测的准确性。本节将介绍环境约束建模的通用方法。

环境约束的数学表示

环境约束通常可以表示为对目标行进难度的量化描述。对于研究区域内任意位置(x, y)，定义环境约束函数C(x, y)表示该位置的通行难度，取值范围为[0, 1]，其中0表示完全可通行，1表示完全不可通行。环境约束函数的构建需要综合考虑多种因素，可表示为：

C(x, y) = f(C₁(x, y), C₂(x, y), ..., C_(n)(x, y)) (2-11)

其中C_(i)(x, y)表示第i种环境因素对应的约束函数，f(⋅)为多种约束的综合函数，可以是加权求和、取最大值或其他组合形式。

主要环境约束因素

环境约束的主要因素包括地形高程、地表覆盖物类型等等，高程变化越大，通行难度越高。不同类型的地表覆盖对目标运动有不同程度的约束。这些因素可以单独建模，然后通过综合函数整合为统一的环境约束模型。环境约束的表征常采用的方式包括栅格代价图、可通行性图、人工势场图等等。栅格代价图将研究区域划分为均匀网格，每个网格赋予一个代价值，表示通行难度。可通行性图通过赋予网格可通行或不可通行的二值属性构建的简化模型。人工势场图以障碍物为中心添加斥力场，以目的地为中心添加引力场，形成势场图，使得目标运动时远离障碍物而趋向目标位置前进。环境约束模型可以是静态的，也可以根据时间、天气等因素动态变化。通过融合多源遥感数据和地理信息，可以构建更加精确的环境约束模型，为目标位置预测提供更可靠的约束条件。

基于历史观测和环境约束的目标位置预测

在多星协同对地观测系统中，由于观测时间窗口的间断性，需要基于历史观测数据和环境约束预测目标在下一观测窗口的位置。这是系统实现连续追踪的关键环节。本节将阐述预测方法的通用模型。

历史观测数据表示

历史观测数据提供了目标过去运动状态的信息，是预测未来位置的基础。历史观测数据可以表示为时空序列：

𝒪 = {(t₁, s₁), (t₂, s₂), ..., (t_(n), s_(n))} (2-12)

其中t_(i)表示观测时刻，s_(i)表示观测到的目标状态，可以包括位置、速度、加速度等信息。基于历史观测数据，可以估计目标的运动特性，如平均速度、运动方向、加速特性等。这些特性可以用统计参数或动力学模型参数表示，作为预测的基础。

环境约束的整合

环境约束对目标运动轨迹有显著影响，应当在预测中加以考虑。整合环境约束的方法有：

约束状态转移：在状态转移中直接考虑环境约束，调整预测轨迹以避开高约束区域。

后处理调整：先进行无约束预测，然后根据环境约束调整预测结果。

概率分布修正：通过环境约束修正预测的概率分布，降低高约束区域的概率。

整合环境约束的状态转移模型可表示为：

s_(t + Δt) = F(s_(t), Δt, C(⋅)) + w_(t) (2-13)

其中C(⋅)表示环境约束函数，影响状态转移过程。

预测不确定性表示

由于观测误差、模型不确定性和环境复杂性，目标位置预测存在不确定性。预测结果通常表示为概率分布：

P(s_(t + Δt)|𝒪,C(⋅)) (2-14)

表示给定历史观测𝒪和环境约束C(⋅)条件下，目标在时刻t + Δt的状态分布。这种概率表示可以采用高斯分布或混合高斯模型等参数化的形式或粒子集合等非参数化形式。对于复杂环境中的运动预测，多模态分布通常更为适合，能够表示多种可能的运动方案。

预测区域确定

基于预测概率分布，可以确定目标在下一观测窗口可能出现的区域。预测区域可以通过概率阈值方法确定：

R_(pred) = {p|P(p) ≥ θ} (2-15)

其中p表示空间位置，P(p)表示目标出现在该位置的概率，θ为概率阈值。预测区域可以作为下一观测窗口内卫星观测的优先区域，提高目标重捕获的效率。预测区域的大小与形状受预测时间跨度、历史观测质量和环境复杂度等因素影响。

本章小结

本章系统阐述了多星协同对地观测系统的基本框架、观测时间窗口约束、地形环境建模及基于历史观测的目标位置预测方法。首先介绍了系统组成与工作原理，明确了卫星观测的基本数学描述；然后详细分析了观测时间窗口的特性及其对系统运行的影响；接着构建了地形约束模型；最后提出了结合运动特性和环境约束的目标位置预测方法。通过本章的数学建模，明确了多星协同对地观测系统中各要素之间的关系，特别是观测时间窗口与目标位置预测之间的关联，为后续研究奠定了理论基础。

基于环境约束的轨迹生成方法

第二章中我们详细探讨了多星协同观测场景下的轨迹预测问题，明确了输入数据规格、输出形式和约束条件。然而，预测任务的研究面临数据稀缺的挑战，真实卫星观测轨迹数据量级非常有限。因此，如何在有限真实数据基础上生成大规模、高质量的合成训练数据，是本章要讨论的主要问题。

研究目标在于设计一套融合地理空间数据、车辆物理约束与战术行为规则的轨迹数据生成框架，通过数据驱动与知识驱动的混合建模策略，生成物理合理且环境多样的合成轨迹数据集。关键技术问题包括：从多源地理数据中提取车辆可通行域并建立环境表示模型；结合战术意图与地形成本设计生成空间路径；通过环境特征与速度的映射关系，将空间路径转化为包含完整时空状态的运动轨迹。生成的数据集将作为第四章深度学习预测模型的训练基础，为模型提供覆盖多种地形与战术场景的充足样本。

本章结构安排如下：3.1节介绍环境数据预处理与可通行域分析，完成坐标系统转换，提取车辆可行驶区域，建立环境栅格数据的统一表示；3.2节阐述战术意图驱动的路径规划方法，通过分层A*算法生成符合战术行为规律的空间路径；3.3节说明数据驱动的速度预测与轨迹生成方法，通过XGBoost模型学习环境特征与速度的映射关系，结合车辆运动学模型完成完整轨迹的仿真生成；3.4节对速度预测模型进行有效性验证，通过K折交叉验证评估模型泛化性能，利用SHAP分析环境特征的影响，确保生成数据的物理合理性。

[图3.1 轨迹生成方法流程]

图3.1 轨迹生成方法流程

图3.1展示了本章提出的轨迹生成方法的整体流程。该方法分为五个主要阶段：首先从多源地理数据（DEM、LULC、OSM道路、OORD真实轨迹）获取环境信息；然后进行环境预处理，包括坐标系转换、可通行域计算和环境成本地图构建；接着结合战术意图进行分层A*路径规划，生成离散的空间路径；随后利用基于OORD数据训练的XGBoost模型进行速度预测；最后通过路径平滑、运动学约束和轨迹仿真生成完整的时空轨迹。整个流程实现了从环境数据到合成轨迹数据集的端到端生成。接下来分小节介绍各阶段。

环境数据预处理

为了构建贴近现实的环境代价模型和速度预测模型，本文利用了开源的真实地理空间数据和轨迹数据。在使用这些数据之前，必须进行预处理，保证坐标系统一，确保所有计算都在同一坐标系下进行。

轨迹数据来源

本研究用于学习环境与速度交互关系的基础轨迹数据来源于OORD数据集（Oxford
Offroad Radar Dataset）^([40])。该数据集由牛津机器人研究所（Oxford
Robotics
Institute）采集并发布，记录了在苏格兰高地崎岖地形和极端天气条件下的车辆运动轨迹数据。OORD数据集包含四个不同地区（Bellmouth、Hydro、Maree、TwoLochs）的总计11次野外数据采集行程。Bellmouth段的路径示意图如。

[]

图3.1 Bellmouth段轨迹采集区域情况^([40])

该数据集是通过GPS系统记录的精确位置数据，包括WGS84坐标系下的经纬度坐标，高时间分辨率的连续观测记录，允许精确计算速度和加速度，除GPS位置外，还包含三维速度、三维加速度等信息。同时，数据采集区域包含森林、灌木、湿地地表覆盖物类型。复杂地形条件下记录的真实运动轨迹，可以反映环境因素对运动的影响，后续章节将会基于这份真实数据研究环境与目标运动特性之间的关系。

[]

图3.2 OORD数据集轨迹速度曲线

环境数据来源

环境特征是影响目标路径选择和移动速度的关键因素。本研究主要使用了两类栅格格式的地理空间数据：

地表覆盖数据描述了地表的不同物理覆盖类型，如森林、草地、水体、城市建成区、裸地等。本研究使用的是中国科学院资源环境科学与数据中心提供的GlobeLand30全球地表覆盖数据集。该数据集具有30米的空间分辨率，采用了10个地表覆盖类别进行分类。GlobeLand30数据集基于2010年至2020年的卫星影像生成，覆盖全球陆地表面，精度达到80%以上，是目前分辨率最高的全球开放地表覆盖数据产品之一。

数字高程图可以提供地表各点的海拔高度信息。本研究采用的是Ferranti提供的高分辨率DEM数据。这些数据主要基于SRTM（Shuttle
Radar Topography
Mission）和其他补充来源整合而成，原始分辨率为3角秒（约90米）。为与地表覆盖数据保持一致，我们对DEM数据进行了双线性插值处理，将其重采样至30米分辨率，从而确保两种环境数据在空间分辨率上的统一。DEM数据是计算坡度、坡向以及分析地形起伏度的基础。

由于OORD数据集的采集范围是在苏格兰高地，要研究其数据中的环境和运动特性关系需要将将研究区域覆盖这一范围。因此本研究选取的研究区域位于北纬57.1°至57.4°和西经4.1°至4.5°之间，覆盖苏格兰高地部分地区。该区域地形复杂多样，既有平坦的河谷地带，也有陡峭的山地，同时包含多种地表覆盖类型，非常适合研究环境因素对目标运动特性的影响。

坐标系统与转换

GPS数据通常使用经纬度坐标进行记录，直接在经纬度上计算欧氏距离、速度或方向是复杂且不精确的，尤其是在局部区域内。因此，必须将所有数据转换到一个统一的平面坐标系中。

投影坐标系如通用横轴墨卡托投影(Universal Transverse Mercator,
UTM)，通过数学投影将地球球面或椭球面的一部分展平到二维平面上。PCS使用米作为单位，在投影带内部能够较好地保持距离、角度的准确性，适合进行分析和计算。

由于研究区域位于英国苏格兰地区，我们选择UTM30N带（EPSG:32630）作为统一的投影坐标系统。该坐标系适用于西经0°至6°之间的区域，非常适合这一研究区域。之后将OORD数据集中WGS84坐标系下的原始GPS轨迹的经纬度坐标通过坐标转换算法，转换为EPSG:32630坐标系下的东向、北向坐标，单位为米。DEM和地表覆盖栅格数据也需要相同操作，从原始的WGS84坐标系重投影到EPSG:32630坐标系，确保环境特征可以根据UTM坐标被准确查询。

通过以上步骤，所有的轨迹点和环境栅格数据都被置于同一个平面坐标系中。在这个坐标系下，可以方便地计算点之间的距离，以及进行基于网格的路径规划和环境特征查询。这一预处理流程是后续所有分析和模拟的基础，确保了空间计算的一致性和准确性。

可通行域计算与连通性分析

路径规划前需从原始环境数据中提取可通行域（passable
region），即车辆理论上能够行驶的区域，这是保证规划算法成功率和起终点有效性的前提条件。研究采用基于LULC黑名单和坡度限制的两层过滤策略，并通过连通性分析确保起终点可达。表3-1给出了GlobeLand30地表覆盖分类体系及其通行性判定。

表3-1 GlobeLand30地表覆盖分类及通行性

  -----------------------------------------------------------------------
  LULC ID         地表类型        通行性          基础代价系数
  --------------- --------------- --------------- -----------------------
  10              耕地            可通行          1.2

  20              森林            可通行          1.8

  30              草地            可通行          1.0

  40              灌木地          可通行          1.5

  50              湿地            不可通行        —

  60              水体            不可通行        —

  70              苔原            可通行          2.0

  80              人造地表        可通行          0.5

  90              裸地            可通行          1.3

  100             冰雪            不可通行        —
  -----------------------------------------------------------------------

首先，根据车辆类型定义不可通行LULC黑名单，将LULC栅格数据中所有黑名单类别的像素标记为不可通行，生成初步可通行掩码
M_(LULC)：

$$M_{LULC}（i，j） = \left\{ \begin{matrix}
1， & \text{LULC}（i，j） \notin \text{Blacklist} \\
0， & \text{otherwise}
\end{matrix} \right.\ $$

其次，即使LULC类别可通行，过大坡度仍会导致车辆无法攀爬或有翻车风险。不同车辆类型具有不同的越野能力，表3.2给出了本研究考虑的四种车辆类型及其关键参数。

表3.2 车辆类型及运动学参数

  --------------------------------------------------------------------------------
  车辆类型    最大速度(m/s)   最大爬坡角(°)   最大加速度(m/s²)   最小转弯半径(m)
  ----------- --------------- --------------- ------------------ -----------------
  车辆类型1   18              30              2.0                8

  车辆类型2   22              25              2.5                6

  车辆类型3   25              20              3.0                5

  车辆类型4   28              15              3.5                10
  --------------------------------------------------------------------------------

根据车辆最大爬坡能力θ_(max)，将坡度超限的像素从可通行域中剔除，生成坡度掩码M_(slope)：

$$M_{slope}(i,j) = \left\{ \begin{matrix}
1, & \text{Slope}(i,j) \leq \theta_{\max} \\
0, & \text{otherwise}
\end{matrix} \right.\ $$

最后，将LULC掩码和坡度掩码取交集，得到最终可通行域 M_(passable)：

M_(passable) = M_(LULC) ∧ M_(slope)

可通行域可能由多个不连通的区域组成，为确保规划起点和终点位于同一连通区域内，采用连通域标记算法统计各连通域像素数量，找到最大连通域；所有起终点生成仅在最大连通域内进行，避免规划失败。

图3.2展示了从原始环境数据到综合成本地图的生成过程。(a)为DEM高程数据，展示了研究区域的地形起伏，高程范围约400-1400米；(b)为基于GlobeLand30的LULC地表覆盖分类，颜色条标注了各类型含义：树木覆盖（深绿）、灌木地（黄绿）、草地（浅绿）、农田（金黄）、裸地（土黄）、水体（蓝色，不可通行）等；(c)为由DEM计算得到的地形坡度，颜色从浅到深表示坡度从0°到40°；(d)为融合地表类型、坡度和高程信息后的综合通行成本地图，绿色区域表示低成本（易于通行），红色区域表示高成本（难以通行），白色区域为不可通行区域。

[图3.2 成本地图生成流程]

图3.2 成本地图生成流程

基于环境代价的路径规划

问题定义与数学描述

路径规划问题形式化定义为：给定一个表示地理环境的网格地图G = (V, E)，其中
V 是所有可通行单元格的集合，E 是相邻单元格间的连接关系。每个单元格 v ∈ V
具有多种属性，包括海拔高度、地表类型和隐蔽度等。对于给定的起点 s ∈ V
和终点 g ∈ V，特定的战术意图 τ，目标是找到一条从 s 到 g 的路径
P = [v₁，v₂，...，v_(n)]，其中 v₁ = s，v_(n) = g，且路径在意图 τ
下的总成本最小。

总成本函数定义为：

$$C_{total}(P,\tau) = \sum_{i = 1}^{n - 1}c(v_{i},v_{i + 1},\tau)$$

其中，c(v_(i), v_(i + 1), τ)是在战术意图 τ 下从单元格 v_(i) 到 v_(i + 1)
的移动成本。该形式化定义将复杂的路径规划问题转化为标准的图搜索问题，为后续的A*算法应用提供了数学基础。

环境代价模型构建

环境代价模型是路径规划的核心，它决定了在不同场景下如何评价路径的质量。本研究考虑了以下主要地形因素：

距离因素：反映路径长度，是所有场景的基本考量，通常使用欧几里得距离计算：

$f_{dist}\left( v_{i},v_{i + 1} \right) = \sqrt{\left( x_{i} - x_{i + 1} \right)^{2} + \left( y_{i} - y_{i + 1} \right)^{2}}$
(3-1)

坡度因素：反映地形起伏对移动的影响，坡度越大，移动难度越高：

$f_{slope}\left( v_{i},v_{i + 1} \right) = \frac{\left| h_{i} - h_{i + 1} \right|}{d\left( v_{i},v_{i + 1} \right)} \cdot s_{factor}$
(3-2)

其中，h_(i)是单元格v_(i)的海拔高度，d(v_(i), v_(i + 1))是两单元格的距离，s_(factor)是坡度惩罚因子。

地表类型代价考虑不同地表类型对移动速度的差异化影响。道路、草地、森林等不同地表类型具有不同的通行难度，代价函数定义为：

$$f_{lulc}(v_{i},v_{i + 1}) = \frac{c_{lulc}(v_{i}) + c_{lulc}(v_{i + 1})}{2}$$

其中c_(lulc)(v)是单元格v对应地表类型的基础代价系数（见表3.1）。

暴露度代价反映车辆在该位置被敌方侦察或火力打击的风险：

$$f_{\exp}(v_{i},v_{i + 1}) = \left( 1 - \frac{veg_{i} + veg_{i + 1}}{2} \right) \cdot e_{factor}$$

其中veg_(i)是单元格v_(i)的植被覆盖度（取值范围0到1），e_(factor)是暴露度惩罚因子。植被覆盖度越高，车辆越容易隐蔽，暴露风险越低。

在不同的战术场景下，总成本函数采用上述因素的加权和形式：

$$c_{\sigma}(v_{i},v_{i + 1}) = \sum_{k = 1}^{4}w_{\sigma,k} \cdot f_{k}(v_{i},v_{i + 1})$$

其中f_(k)是第k个因素的成本函数，w_(σ, k)是该因素在场景σ下的权重。通过调整不同场景下的权重配置，可以生成符合不同战术意图的路径。表3.3给出了本研究设计的三种战术意图及其对应的权重配置。

表3.3 战术意图权重配置

  -----------------------------------------------------------------------------------------------------------
  战术意图   距离权重   坡度权重   地表权重   暴露度权重   路径特点
  ---------- ---------- ---------- ---------- ------------ --------------------------------------------------
  意图1      1.0        0.5        1.0        0.0          优先选择道路和平坦地形，追求最短时间到达

  意图2      0.3        0.3        0.5        2.0          优先选择森林等高植被覆盖区域，牺牲速度换取隐蔽性

  意图3      0.5        2.0        1.0        0.5          优先避开陡峭地形，适合重型车辆或恶劣天气条件
  -----------------------------------------------------------------------------------------------------------

分层A*搜索算法

由于环境栅格地图的像素量较大，在原始栅格图上进行路径规划，传统的A*算法计算复杂度较高，搜索过程回消耗大量时间和内存。因此，本研究采用分层搜索策略，该策略在低分辨率地图上确定路径的整体走向，在高分辨率地图上规划细节。

首先，对原始高分辨率地图G进行降采样，得到低分辨率地图G′ = (V′, E′)。降采样比例定义为α，即将α × α的网格单元合并为一个低分辨率单元。低分辨率地图中每个单元格的属性由对应高分辨率区域的聚合函数确定，海拔高度取区域内的平均值，地表类型取区域内占比最大的类型进行代表。形式化表示为：对于低分辨率地图中的单元格v′ ∈ V′，其属性attr(v′)由对应的高分辨率区域R(v′) ⊂ V计算得出：

attr(v′) = f_(aggr)({attr(v)|v ∈ R(v′)}) (3-3)

其中，f_(aggr)是针对不同属性的聚合函数。

分层A*搜索包含两个主要阶段：

粗规划阶段：在低分辨率地图G′上，将起点s和终点t映射为对应的低分辨率坐标s′和t′，使用A*算法搜索从s′到t′的最优路径P′ = {v′₁, v′₂, ..., v′_(m)}。

细规划阶段：将粗略路径P′分割为多个子段，在高分辨率地图上逐段进行精细规划。对于相邻的两个低分辨率路径点v′_(i)和v′_(i + 1)，在高分辨率地图上找到对应的代表点v_(i)^(H)和v_(i + 1)^(H)，然后使用A*算法在高分辨率地图上搜索从v_(i)^(H)到v_(i + 1)^(H)的最优子路径。

图3.3展示了两阶段A路径规划的示意图。(a)为粗规划阶段，在10倍降采样的成本地图上执行A搜索，快速确定大致路线方向，路径长度约72.6km；(b)为精细规划阶段，在原始分辨率的成本地图上，沿粗规划路径每5km设置航路点，在2km缓冲走廊内进行局部A*优化，生成更精确的最终路径，路径长度约73.4km。起终点直线距离约68.7km，可以观察到精细规划路径相比粗规划路径具有更多的局部细节，更好地适应了高分辨率成本地图中的地形变化。

[]

图3.3 分层规划结果示例图

目标点定义与场景设定

为提升训练数据的多样性和真实性，本文设计了两种目标点生成策略，覆盖随机探索、固定目标导向场景。

随机策略（Random）在最大连通域内随机采样起点和终点，确保两点满足最小距离约束。采样流程包括：在可通行掩码
M_(passable)
的最大连通域内随机选取200个候选点；从候选点中随机抽取2个点作为起终点；验证约束，直线距离
≥
80km。用途为生成覆盖全区域、路径走向随机的轨迹，提升模型对未知场景的泛化能力。每个区域×车辆×意图组合生成随机轨迹。

表3.5给出了轨迹生成的完整配置矩阵。通过组合不同的区域、车辆类型、战术意图和目标策略，可以生成覆盖多种场景的大规模轨迹数据集。

表3.5 轨迹生成配置矩阵

  ------------------------------------------------------------------------
  配置维度     选项                                             数量
  ------------ ------------------------------------------------ ----------
  地理区域     波西米亚森林、顿巴斯、喀尔巴阡山、苏格兰高地     4

  车辆类型     车辆类型1、车辆类型2、车辆类型3、车辆类型4       4

  战术意图     意图1、意图2、意图3                              3

  目标策略     随机、POI导向                                    2

  总组合数                                                      96
  ------------------------------------------------------------------------

基于路径关键点的轨迹生成

A*算法生成的路径仅包含空间上的位置序列，缺乏时间、速度和加速度等运动学信息。真实世界中，目标运动不仅受到路径约束，还受到环境特征和运动学限制的影响。本节介绍如何将离散路径点转换为包含完整运动特性的轨迹数据。轨迹生成的核心流程包括：（1）路径平滑：使用三次样条插值将A*输出的离散路径点转换为平滑曲线；（2）速度预测：基于XGBoost模型预测每个路径点的参考速度；（3）运动学约束：应用车辆加速度、转向角等物理限制；（4）轨迹仿真：通过PID控制器和Pure
Pursuit控制器生成完整的时空轨迹。

图3.4展示了波西米亚森林区域车辆类型1在意图3下的轨迹生成结果。(a)为轨迹的空间分布，总长度约100km，颜色表示该点的瞬时速度，红色表示高速（约18
m/s），蓝色表示低速（约14
m/s）；轨迹呈现明显的弯曲形态，体现了路径规划对复杂地形的适应性。(b)为速度随时间的变化曲线，蓝色实线为车辆仿真的实际速度，红色虚线为XGBoost模型预测的参考速度。可以观察到实际速度围绕参考速度波动；平均速度约16.8
m/s（约60 km/h），最大速度约19.4 m/s（约70
km/h），符合车辆类型1的越野速度特性。

[图3.4 轨迹生成结果]

图3.4 轨迹生成结果

图3.5展示了不同车辆类型在相同战术意图下的轨迹对比。图中展示了四种车辆类型（车辆类型1-4）在同一起终点条件下的路径规划结果。车辆类型1和2的路径长度约131.7km，平均速度约64.0km/h；车辆类型3的路径长度约173.6km，平均速度约82.3km/h；车辆类型4的路径长度约177.6km，平均速度约85.9km/h。不同车辆类型由于越野能力和速度特性的差异，呈现出明显不同的路径选择策略：越野能力强的车辆倾向于选择更直接的路径，而越野能力弱的车辆则倾向于绕行以避开复杂地形。

[]

图3.5
不同车辆类型轨迹及运动特征对比：(a)轨迹对比；(b)速度分布；(c)速度曲线对比；(d)沿轨迹高程剖面

图3.6展示了不同战术意图在相同车辆类型下的路径规划对比。图中展示了三种战术意图（意图1-3）在同一起终点条件下的路径规划结果。意图1的路径长度约248.1km，弯曲度1.21；意图2的路径长度约267.6km，弯曲度1.31；意图3的路径长度约253.7km，弯曲度1.24。不同战术意图对应不同的代价函数权重配置，导致路径选择呈现明显差异：意图1倾向于选择最短路径，意图2倾向于绕行高地以规避地形障碍，意图3则倾向于利用植被覆盖区域以提高隐蔽性。

[]

图3.6
不同战术意图路径及地形特征对比：(a)路径对比；(b)沿途坡度分布；(c)坡度随距离变化；(d)沿轨迹高程剖面

路径平滑方法

A*算法直接输出的路径通常由一系列网格单元中心点连接而成，可能包含不自然的锯齿状锐角转弯。为了使路径更符合现实中车辆的平滑运动轨迹，需要进行平滑处理。本研究采用基于三次样条插值的方法。

首先，将原始路径点{(x_(i), y_(i))}_(i = 1)^(n)（UTM坐标）按累积弦长进行参数化，得到参数序列{t_(i)}_(i = 1)^(n)，其中：

$$t_{i} = \sum_{j = 1}^{i - 1}\sqrt{(x_{j + 1} - x_{j})^{2} + (y_{j + 1} - y_{j})^{2}}$$

然后，分别对x和y坐标构建三次样条函数S_(x)(t)和S_(y)(t)，使得插值曲线通过所有原始路径点，并在连接点处保持一阶和二阶导数连续（C²连续性）。在参数区间[t₁, t_(n)]上，以固定步长Δt重新采样样条曲线，得到更密集、更平滑的路径点序列{(S_(x)(t_(j)), S_(y)(t_(j)))}_(j = 1)^(m)，其中m > n。

同时使用距离阈值参数d_(max)控制插值点的密度，确保相邻点之间的距离不超过d_(max)（本研究取d_(max) = 100m），以满足后续速度预测和轨迹仿真的时间步长要求。

数据驱动的环境交互速度模型

在获得平滑路径后，需要为每个路径点预测其参考移动速度。与传统的基于经验公式的方法不同，研究采用数据驱动的机器学习方法，从真实越野轨迹数据中学习环境特征与速度之间的复杂非线性映射关系。

对于平滑路径上的每个点
(x_(i)，y_(i))，构建一个多维特征向量，捕捉该点的环境属性、地形几何特征和路径局部特性。表3.6给出了特征向量的完整定义。

表3.6 速度预测特征向量定义

  -------------------------------------------------------------------------
  特征类别       特征名称                       维度    数据来源
  -------------- ------------------------------ ------- -------------------
  地形特征       DEM高程                        1       DEM栅格

                 地形坡度                       1       DEM计算

                 坡向正弦/余弦                  2       DEM计算

  地表特征       LULC类别(one-hot)              10      GlobeLand30

                 树木覆盖度                     1       植被指数

  几何特征       有效坡度                       1       路径+DEM

                 路径曲率                       1       路径计算

                 过去10m平均曲率                1       路径计算

                 未来10m最大曲率                1       路径计算

  道路特征       是否在道路上                   1       OSM

  合计                                          20      
  -------------------------------------------------------------------------

采用XGBoost(eXtreme Gradient
Boosting)作为速度预测的核心模型。XGBoost是一种基于梯度提升决策树(GBDT)的集成学习算法，具有非线性建模能力，能够自动捕捉环境特征与速度之间的复杂非线性关系，可通过特征重要性和SHAP值分析模型决策依据。

使用真实越野轨迹数据（OORD数据集）作为训练样本。对于数据集中的每个轨迹点，提取其环境特征和实际速度。由于速度分布呈右偏态，对目标变量进行对数变换以改善模型拟合效果：

y = log(1 + v)

模型训练目标为最小化预测与真实值的均方误差（MSE），同时加入正则化项防止过拟合：

$$\mathcal{L} = \frac{1}{N}\sum_{i = 1}^{N}({\widehat{y}}_{i} - y_{i})^{2} + \Omega(\Theta)$$

其中Ω(Θ)为L1和L2正则化项的组合。对于新生成的规划路径，逐点提取特征向量，输入训练好的XGBoost模型获取预测值ŷ_(i)，然后通过逆变换恢复实际速度：

v_(ref, i) = exp(ŷ_(i)) − 1

表3.7给出了XGBoost模型的主要超参数配置。

表3.7 XGBoost模型超参数配置

  ------------------------------------------------------------------------
  参数                           设置值        说明
  ------------------------------ ------------- ---------------------------
  n_estimators                   200           树的数量

  max_depth                      6             最大树深度

  learning_rate                  0.1           学习率

  subsample                      0.8           样本采样比例

  colsample_bytree               0.8           特征采样比例

  reg_alpha                      0.1           L1正则化系数

  reg_lambda                     1.0           L2正则化系数
  ------------------------------------------------------------------------

轨迹运动学约束

在获得路径上每个点的预测速度后，需要将其转换为包含时间戳的完整轨迹序列，并确保满足基本的运动学约束。轨迹生成采用前向积分方法，从平滑路径的第一个点开始，初始时间戳T₀ = 0。

对于路径上相邻两点P_(j)和P_(j + 1)，它们之间的距离为：

Δs_(j) =  ∥ P_(j + 1) − P_(j)∥₂

该段的平均速度取两端点预测速度的均值：

$$v_{avg,j} = \frac{v(P_{j}) + v(P_{j + 1})}{2}$$

通过该段所需的时间为：

$$\Delta t_{j} = \frac{\Delta s_{j}}{v_{avg,j}}$$

下一个点的时间戳T_(j + 1) = T_(j) + Δt_(j)。重复此过程，即可为所有路径点生成时间戳。

在生成时间戳和速度序列的过程之后，需要施加运动学约束以确保轨迹的物理合理性。本研究考虑了三类约束条件：

最大速度约束：限制任何点的速度v(P_(j))不超过车辆类型对应的最大速度v_(max)（见表3.2），防止出现超出车辆性能极限的不合理速度：

v(P_(j)) ≤ v_(max)

加速度约束：通过计算相邻时间步之间的速度变化得到瞬时加速度，并确保加速度始终在允许的范围内：

$$a_{j} = \frac{v(P_{j + 1}) - v(P_{j})}{\Delta t_{j}},\quad a_{j} \in \lbrack - a_{decel,max},a_{accel,max}\rbrack$$

若计算出的加速度超出范围，则需要回调调整速度或时间步长。

转弯约束：通过速度模型中的曲率特征直接考虑转弯对速度的影响，保证车辆在弯道处合理减速。此外，根据车辆最小转弯半径R_(min)（见表3.2），限制高速行驶时的最大曲率：

$$\kappa_{\max} = \frac{1}{R_{\min}}$$

通过上述转换流程，本研究将空间路径转化为包含位置(x, y)、时间戳T、速度v和航向角θ的完整轨迹数据，同时确保了轨迹的物理合理性。最终生成的轨迹数据格式如表3.8所示。

表3.8 生成轨迹数据格式

  ------------------------------------------------------------------------
  字段                   类型      单位      说明
  ---------------------- --------- --------- -----------------------------
  timestamp              float     s         相对时间戳

  x                      float     m         UTM东向坐标

  y                      float     m         UTM北向坐标

  speed                  float     m/s       瞬时速度

  heading                float     rad       航向角

  acceleration           float     m/s²      瞬时加速度

  curvature              float     1/m       路径曲率
  ------------------------------------------------------------------------

轨迹生成方法的实验验证与分析

验证环境-速度映射模型的有效性和生成轨迹的合理性，基于11条真实越野轨迹进行系统的实验评估。实验采用K-fold交叉验证评估模型稳定性，LOOCV留一交叉验证评估跨轨迹泛化能力，并通过SHAP可解释性分析揭示环境特征对速度的影响机制。

K-fold交叉验证

为评估模型的稳定性和泛化能力，避免过拟合问题，采用分段5折交叉验证方法对速度预测模型进行系统评估。数据集按轨迹顺序划分为5个不重叠片段，每个片段包含约1000个数据点，确保训练集与验证集在时间或空间分布上相互独立。该划分方式模拟了模型在新区域或新时段的预测能力。

模型性能通过三类指标综合评估：

R²（决定系数）：衡量模型解释数据方差的能力，数值越接近1表示拟合效果越好。

RMSE（均方根误差）：以m/s为单位，直接反映预测速度与真实速度的偏离程度。

MAPE（平均绝对百分比误差）：从相对误差角度评价模型精度，对不同速度范围的预测提供归一化的比较基准。

表3.9 K-fold交叉验证结果

  ------------------------------------------------------------------------------------
  Fold   R²(训练)   RMSE(训练)   MAPE(训练,%)   R²(验证)   RMSE(验证)   MAPE(验证,%)
  ------ ---------- ------------ -------------- ---------- ------------ --------------
  1      0.9469     0.761        9.25           0.8025     1.346        14.38

  2      0.9444     0.750        8.72           0.8293     1.453        17.95

  3      0.9478     0.764        9.06           0.7793     1.342        14.72

  4      0.9441     0.767        8.98           0.8209     1.387        14.49

  5      0.9438     0.755        8.45           0.8425     1.389        17.39

  均值   0.9454     0.759        8.89           0.8149     1.383        15.79
  ------------------------------------------------------------------------------------

从表中可以观察到训练集上的精度表明模型具备强大的拟合能力。5折训练集的R²均超过0.98，RMSE稳定在0.44
m/s左右，MAPE约为6.4%，说明XGBoost成功捕捉了环境特征与速度之间的复杂非线性映射关系；同时验证集平均R²达到0.809，RMSE约为1.4
m/s(对应±5
km/h的预测误差)。5个折叠之间的性能波动很小，验证集R²的标准差仅为0.028，RMSE标准差为0.032
m/s，表明模型对数据划分方式不敏感，具有良好的稳定性。

图3.6展示了模型预测速度与真实速度的对比曲线。蓝色实线为真实观测速度，红色虚线为模型预测速度。模型在大部分区段都能较好地跟随真实速度的变化趋势，特别是在速度平稳变化的区域。在速度剧烈波动的幅值上，模型预测与真实观测之间存在一定偏差。

[]

图3.6 真实速度与预测速度对比曲线

与人类驾驶员的对比验证

现实世界中同一人同一路线多次驾驶，驾驶过程的速度变化也并不能达到完全的一致。因此，虽然模型对每条轨迹的速度曲线预测结果的R²在0.8左右，但是但更有意义的评估方式是将模型预测的一致性与人类驾驶员自身的重复驾驶一致性进行对比。

实验设计如下：对每个目标轨迹T，与同组其它轨迹逐点做空间最近邻配对，并计算R²，得到人类组内R²。模型用除T之外的其他轨迹训练得到的模型，对T进行配对计算得到模型R²，再与人类组内R²逐对比较，并给出分组汇总。

[]

图3.8 人类组内R²分布与模型LOOCV R²对比

实验结果表明，人类组内R²均值为0.481，而模型LOOCV
R²均值为0.802，模型预测一致性显著高于人类重复驾驶的一致性。具体而言，驾驶员A在路线1上的人类组内R²范围为0.04~0.72，而模型LOOCV
R²达到0.81~0.91；驾驶员B在路线2上的人类组内R²约为0.68，模型LOOCV
R²为0.76；驾驶员C在路线3上的人类组内R²范围为0.400.62，模型LOOCV
R²为0.63~0.88。在所有对比中，模型对目标轨迹的预测一致性均不低于人类重复驾驶的一致性。这一结果表明，基于环境特征的速度预测模型能够有效捕捉驾驶行为。

SHAP特征重要性分析

模型的可解释性对于理解环境-速度映射机制至关重要。尽管XGBoost在预测精度上表现优异，但其作为集成树模型的黑箱特性使得难以直观理解各环境特征对速度的具体影响方式。为探寻模型对环境的理解方式，采用SHAP(SHapley
Additive
exPlanations)值进行全局特征重要性分析。SHAP值源自博弈论中的Shapley值概念，核心思想是将模型预测结果视为所有特征共同贡献的结果，通过计算每个特征在所有可能的特征子集组合中的边际贡献，量化该特征对最终预测的影响权重。

图3.11展示了SHAP特征重要性的柱状图，直观呈现了各特征对速度预测的贡献。图3.12则为SHAP汇总图，每个点代表一个样本，横坐标为SHAP值(正值表示增加速度预测，负值表示降低)，颜色表示特征值大小(红色为高值，蓝色为低值)。从图中高曲率值(红点)普遍对应负SHAP值，即高曲率导致速度降低；而林地特征同样表现出类似的负向影响。

[]

图3.12 SHAP特征影响汇总图(每点为一个样本)

分析结果表明，曲率相关特征对速度预测的影响最为显著：过去10m平均曲率和未来10m最大曲率位居前两位，表明驾驶员的速度决策高度依赖于当前和即将遇到的弯道情况。从图中可以观察到，高曲率值普遍对应负SHAP值，即高曲率导致速度降低，这符合驾驶员在弯道减速的物理直觉。地形特征方面，DEM高程、坡向和地形坡度均表现出较强的影响力，验证了地形对越野行驶速度的重要约束作用。此外，树木覆盖作为地表覆盖类型中最重要的特征，同样表现出负向影响，高覆盖率区域速度明显降低，反映了林地环境对行驶速度的显著限制。

本章小结

本章提出了一套基于环境约束的轨迹生成方法，用于模拟目标在复杂地理环境下的运动行为。该方法通过数据驱动与知识驱动的混合建模策略，生成物理合理且环境多样的合成轨迹数据集。

在环境数据预处理方面，本章利用高分辨率DEM和GlobeLand30地表覆盖数据，建立了统一的UTM坐标系环境表示模型。通过LULC黑名单和坡度限制的两层过滤策略提取可通行域，并采用连通域分析确保起终点可达性，为后续路径规划奠定了基础。

在路径规划方面，本章构建了综合考虑距离、坡度、地表类型和隐蔽度的多因素环境代价模型，并设计了多种战术意图场景以模拟多样化的运动目的。采用分层A*搜索算法在降采样地图上进行粗规划、在原始地图上进行细规划，有效平衡了规划效率与路径质量。

在速度预测方面，本章基于OORD真实越野轨迹数据，提取包含地形、曲率、地表覆盖等15-25维特征向量，训练XGBoost梯度提升模型学习环境特征与速度的非线性映射关系。K-fold交叉验证表明模型验证集R²达到0.815，RMSE约为1.38
m/s，具有较好的预测精度。

在模型验证方面，本章通过与人类驾驶员重复驾驶一致性的对比实验，证明模型预测一致性（R²=0.802）显著高于人类组内一致性（R²=0.481）。SHAP分析揭示了曲率、地形高程、树木覆盖等特征对速度预测的关键影响机制，验证了模型决策的物理合理性。

本章方法仍存在一定局限性。速度预测模型基于单一数据集（OORD）训练，对其他地理区域的泛化能力有待验证。环境代价模型中的权重参数依赖人工设定，缺乏自适应调整机制。此外，轨迹生成未考虑动态障碍物和多目标交互场景，这些问题将在后续研究中进一步探讨。但是轨迹生成方法通过结合环境代价路径规划和基于真实数据分析的速度建模，模拟了目标在复杂环境下的移动行为，为第四章深度学习预测模型的训练提供了覆盖多种地形与战术场景的充足样本支撑。

基于意图感知的目标位置预测方法

第三章通过融合环境约束、车辆动力学与数据驱动方法，构建了大规模合成轨迹数据集，为深度学习模型训练提供了充足的样本支撑。本章在此基础上，围绕具备环境感知能力的长时域轨迹预测模型设计这一问题展开研究。

模型需要观测稀疏、地形复杂、候选终点不确定的情况下保持预测稳定性，同时刻画历史运动模式、环境约束以及候选终点之间的关系。为此，本章提出一种融合多源地理信息的目标驱动轨迹预测方法，该方法受TNT
(Target-driven Trajectory Prediction)
框架启发，但在环境建模、特征融合和解码策略上进行了改进，引入DEM地形、坡度、土地利用等地理约束信息。因此，本文将该方法命名为Terrain-aware
TNT
(TerraTNT)，以强调其地形感知能力。与传统序列到序列预测方法不同，提出的模型采用意图感知的分层预测范式，首先推断目标可能到达的候选终点位置及其概率分布；然后以预测的候选终点为条件生成相应完整轨迹。通过将复杂的长时域序列生成问题分解为终点选择和终点条件下的轨迹预测，可以降低预测难度，为卫星任务规划提供丰富决策信息。

本章结构安排如下：4.1节详述模型结构设计；4.2节介绍训练策略与损失函数；4.3节给出评价指标与基线模型；4.4节至4.6节依次呈现基线对比实验、控制变量分析和消融实验；4.7节提供定性案例分析；4.8节进行跨区域泛化实验；4.9节总结主要发现并讨论局限与应用启示。

模型整体架构

TerraTNT采用目标驱动的设计思想，将长时域轨迹预测分解为“目标选择”与“轨迹生成”两个子任务。模型整体架构如图4.1所示，包含环境编码器、历史轨迹编码器、目标分类器和轨迹生成器四个核心模块。

[图4.1 模型整体架构]

图4.1 TerraTNT模型整体架构图

模型的数据流如下：输入层包含三类数据，分别是环境地图（B × 18 × H × W）、历史轨迹（B × 90 × 26）和候选终点（B × K × 2）。编码层通过CNN编码器、LSTM编码器和MLP编码器分别提取环境特征（E，128维）、历史特征（H，128维）和候选特征（C，K × 64维）。特征融合层将三类特征拼接为B × K × 320维的联合表示。目标推理模块通过MLP分类器计算各候选终点的概率分布P(g)，并通过argmax选取最可能的目标。轨迹生成器以选定目标为条件，通过LSTM解码器生成360步（60分钟）的预测轨迹。

环境编码器

环境编码器负责从多通道栅格地图中提取空间特征，其设计目标是将高维的地理环境信息压缩为紧凑的特征表示，供后续模块使用。输入为18通道的全局环境地图M ∈ ℝ^(B × 18 × H × W)，其中B为批量大小，H和W分别为地图的高度和宽度（本文设置为128×128像素，对应100km×100km的地理范围）。

这18个通道的详细构成如表4.1所示，涵盖地形、土地覆盖、道路网络和辅助信息四个方面。

表4.1 环境编码器输入通道列表

  ---------------------------------------------------------------------------------
  通道编号   通道名称                数据来源        说明
  ---------- ----------------------- --------------- ------------------------------
  0          DEM高程                 SRTM 30m        数字高程模型，单位：米

  1          地形坡度                DEM衍生         地表坡度，单位：度

  2          坡向正弦                DEM衍生         sin(aspect)，范围[-1, 1]

  3          坡向余弦                DEM衍生         cos(aspect)，范围[-1, 1]

  4          耕地 (code 10)          GlobeLand30     土地覆盖类别（one-hot）

  5          森林 (code 20)          GlobeLand30     土地覆盖类别（one-hot）

  6          草地 (code 30)          GlobeLand30     土地覆盖类别（one-hot）

  7          灌木地 (code 40)        GlobeLand30     土地覆盖类别（one-hot）

  8          湿地 (code 50)          GlobeLand30     土地覆盖类别（one-hot）

  9          水体 (code 60)          GlobeLand30     土地覆盖类别（one-hot）

  10         苔原 (code 70)          GlobeLand30     土地覆盖类别（one-hot）

  11         人造地表 (code 80)      GlobeLand30     土地覆盖类别（one-hot）

  12         裸地 (code 90)          GlobeLand30     土地覆盖类别（one-hot）

  13         冰川和永久积雪 (code    GlobeLand30     土地覆盖类别（one-hot）
             100)                                    

  14         信息缺失(code 255)      -               土地覆盖类别（one-hot）

  15         道路网络                OpenStreetMap   二值栅格，1=道路，0=非道路

  16         历史轨迹热图            动态生成        历史轨迹的空间分布密度

  17         候选终点分布            动态生成        候选目标的空间分布（高斯核）

  总计       18                                      
  ---------------------------------------------------------------------------------

地形通道（0-3）刻画地形起伏对车辆运动的约束，土地覆盖通道（4-14）表征不同地表类型对通行能力的影响，道路通道（15）标识道路的空间分布，辅助通道（16-17）增强模型对当前运动状态和潜在目标的感知。所有通道在训练前已进行归一化处理。

编码器采用四层卷积神经网络结构。每层由3×3卷积核、批归一化、ReLU激活函数和步长为2的下采样操作组成，通道数依次为32、64、128和128。经过四次下采样后，特征图的空间分辨率降至原始尺寸的1/16。随后通过自适应平均池化将特征图压缩至固定的4×4大小，最后经全连接层映射为128维的环境特征向量E ∈ ℝ^(B × 128)。整个编码过程可表示为：

E = FC(Flatten(AdaptiveAvgPool(Conv₄(Conv₃(Conv₂(Conv₁(M)))))))

该设计使得环境编码器能够在保留关键地理信息的同时，将高维输入压缩为适合与其他模块融合的紧凑表示。环境编码器的网络结构如图4.2所示。

[图4.2 环境编码器结构]

图4.2 环境编码器网络结构示意图

历史轨迹编码器

历史轨迹编码器负责从观测期内的车辆运动序列中提取时序特征，采用双层LSTM网络实现。输入为长度为T的状态向量序列{x₁, x₂, …, x_(T)}，其中T = 90对应15分钟的观测窗口（采样间隔10秒），每个状态向量x_(t) ∈ ℝ²⁶包含该时刻的运动学信息和环境上下文。

这26维特征的详细构成如表4.2所示，涵盖运动学、地形、土地覆盖和道路信息四个方面。

表4.2 历史轨迹输入特征列表

  ------------------------------------------------------------------------------------
  类别           特征名称                  维度   单位/范围   说明
  -------------- ------------------------- ------ ----------- ------------------------
  运动学特征     x, y                      2      m           相对于起点的位置坐标

                 velocity_x, velocity_y    2      m/s         速度的东向和北向分量

                 acceleration_x,           2      m/s²        加速度的东向和北向分量
                 acceleration_y                               

                 heading_sin, heading_cos  2      [-1, 1]     航向角的正弦和余弦值

                 curvature                 1      1/m         轨迹曲率，反映转向程度

                 speed_ms                  1      m/s         速度标量（速度大小）

  地形特征       dem_agg                   1      m           当前位置的聚合高程值

                 slope_agg                 1      度          当前位置的聚合坡度

                 aspect_sin_agg,           2      [-1, 1]     坡向角的正弦和余弦值
                 aspect_cos_agg                               

  土地覆盖特征   lulc_10 (耕地)            1      {0, 1}      GlobeLand30 code 10

                 lulc_20 (森林)            1      {0, 1}      GlobeLand30 code 20

                 lulc_30 (草地)            1      {0, 1}      GlobeLand30 code 30

                 lulc_40 (灌木地)          1      {0, 1}      GlobeLand30 code 40

                 lulc_50 (湿地)            1      {0, 1}      GlobeLand30 code 50

                 lulc_60 (水体)            1      {0, 1}      GlobeLand30 code 60

                 lulc_70 (苔原)            1      {0, 1}      GlobeLand30 code 70

                 lulc_80 (人造地表)        1      {0, 1}      GlobeLand30 code 80

                 lulc_90 (裸地)            1      {0, 1}      GlobeLand30 code 90

                 lulc_100 (冰川和永久积雪) 1      {0, 1}      GlobeLand30 code 100

  道路特征       on_road                   1      {0, 1}      是否在道路上

  总计                                     26                 
  ------------------------------------------------------------------------------------

运动学特征刻画车辆的即时运动状态，地形和土地覆盖特征反映车辆所处位置的环境条件，道路特征指示车辆是否沿道路行驶。所有特征在训练前已进行归一化处理。

LSTM网络的隐藏维度设为128，采用双层堆叠结构以增强时序建模能力。编码器取序列最后时刻的隐状态h_(T)，经全连接层映射为128维的历史特征向量H ∈ ℝ^(B × 128)：

H = FC(h_(T)),  h_(T) = LSTM(x₁, x₂, …, x_(T))

该设计使得历史轨迹编码器能够捕捉车辆运动的时序演化规律，包括速度变化趋势、转向模式以及与环境的交互特征。历史轨迹编码器的网络结构如图4.3所示。

[图4.3 历史轨迹编码器结构]

图4.3 历史轨迹编码器网络结构示意图

目标分类器

目标分类器负责从K个候选终点中预测最可能的目标位置。候选终点由数据集提供，来源于距离当前位置3000米范围内的兴趣点（POI）。

首先，将每个候选终点的相对坐标(dx_(k), dy_(k))通过两层MLP编码为64维嵌入向量C_(k)：

C_(k) = MLP_(goal)([dx_(k), dy_(k)])

然后，将历史特征H、环境特征E与候选嵌入C_(k)拼接，送入三层分类器网络计算每个候选的logit分数：

s_(k) = MLP_(cls)([H; E; C_(k)])

最终通过Softmax归一化得到目标概率分布：

$$P(g_{k}|H,E) = \frac{\text{exp}(s_{k})}{\sum_{j = 1}^{K}\text{exp}(s_{j})}$$

目标分类器的网络结构如图4.4所示。

[图4.4 目标分类器结构]

图4.4 目标分类器网络结构示意图

轨迹生成器

轨迹生成器以选定的目标位置为条件，生成从当前位置到目标的完整轨迹。采用双层LSTM解码器结构，隐藏维度256。

解码器输入为历史特征H、环境特征E与目标嵌入G的拼接向量，在每个时间步重复输入：

input_(t) = [H; E; MLP_(goal)(g^(*))]

其中g^(*) ∈ ℝ²为选定的目标坐标。解码器输出经线性层映射为2维位移预测：

Δp_(t) = FC(h_(t)^(dec))

最终预测轨迹为360步（60分钟）的位移序列{Δp₁, Δp₂, …, Δp₃₆₀}。轨迹生成器的网络结构如图4.5所示。

[图4.5 轨迹生成器结构]

图4.5 轨迹生成器网络结构示意图

训练策略与损失函数

双任务联合训练

本文采用目标分类与轨迹回归的双任务联合训练策略，同时优化目标选择和轨迹生成两个子任务。训练时，将真实终点放置于候选列表首位（索引0），以提供明确的监督信号。

目标分类损失采用交叉熵形式，监督模型从候选集中选择正确的目标位置。设真实目标对应的候选索引为0，则分类损失定义为：

ℒ_(cls) = −logP(g₀|H, E)

轨迹回归损失采用均方误差形式，监督模型生成与真实轨迹一致的位移序列。设预测位移为Δp̂_(t)，真实位移为Δp_(t)，则回归损失定义为：

$$\mathcal{L}_{\text{traj}} = \frac{1}{T}\sum_{t = 1}^{T} \parallel \Delta{\widehat{p}}_{t} - \Delta p_{t} \parallel_{2}^{2}$$

总损失函数为上述两项的加权和。本文采用等权重策略，即ℒ = ℒ_(cls) + ℒ_(traj)。该设计使得模型在训练过程中同时学习目标推理和轨迹生成能力，两个任务相互促进：准确的目标预测为轨迹生成提供正确的终点约束，而轨迹生成的反馈则有助于模型理解不同目标的可达性。

训练配置

模型训练在配备NVIDIA RTX 3090 GPU的工作站上进行，采用PyTorch
2.0深度学习框架实现。优化器选用AdamW，初始学习率设为1×10⁻⁴，批量大小为64，最大训练轮数为50。为保证实验的可重复性，所有随机种子固定为42。详细的训练超参数配置如表4.3所示。

表4.3 训练超参数配置

  -----------------------------------------------------------------------
  参数                     设置值
  ------------------------ ----------------------------------------------
  GPU                      NVIDIA RTX 3090 (24GB)

  深度学习框架             PyTorch 2.0

  优化器                   AdamW

  初始学习率               1×10⁻⁴

  批量大小                 64

  训练轮数                 50

  随机种子                 42
  -----------------------------------------------------------------------

图4.6展示了模型在波西米亚森林区域的训练过程。(a)为验证集损失函数收敛曲线，可以观察到损失在前5轮快速下降，随后逐渐收敛；(b)为验证集ADE收敛曲线，模型在约第25轮达到最优性能（ADE约1.2km），此后趋于稳定。

[图4.6 训练曲线]

图4.6 训练曲线

推理策略

推理阶段，模型首先计算所有候选终点的概率分布，选取概率最高的候选作为预测目标：

$$g^{*} = \text{arg}\underset{k}{\text{max}}P(g_{k}|H,E)$$

然后以g^(*)为条件生成完整轨迹。此外，模型支持Top-K多轨迹输出模式，为每个Top-K候选分别生成轨迹，供下游任务进行多假设推理。

评价指标

本文采用三类指标评估轨迹预测性能，分别从整体轨迹精度、终点预测精度和目标选择可靠性三个维度进行衡量。

平均位移误差（Average Displacement Error,
ADE）计算预测轨迹与真实轨迹所有时间步的平均欧氏距离，反映模型对完整轨迹的预测精度。设预测轨迹为{p̂₁, p̂₂, …, p̂_(T)}，真实轨迹为{p₁, p₂, …, p_(T)}，则$\text{ADE} = \frac{1}{T}\sum_{t = 1}^{T} \parallel {\widehat{p}}_{t} - p_{t} \parallel_{2}$。该指标能够综合反映轨迹预测在各个时间段的表现。

终点位移误差（Final Displacement Error,
FDE）计算预测终点与真实终点的欧氏距离，即FDE =  ∥ p̂_(T) − p_(T)∥₂。该指标对于导航和拦截任务尤为重要，因为这类任务的核心目标是准确预测车辆的最终目的地。

终点精度（Endpoint Precision at K,
EP@K）计算预测终点落在真实终点最近的Top-K候选中的比例，用于评估目标分类器的可靠性。当模型输出的Top-K候选中包含真实目标时，即使首选目标不正确，下游任务仍可通过多假设推理获得正确结果。

对比实验

三阶段评估

为系统评估模型的泛化能力，本文设计了三阶段评估框架，如表4.4所示。该框架通过控制“目标点在训练集中的可见性”与“候选集的完备性”两个变量，构建从理想到严苛的渐进式评估条件。

表4.4 三阶段评估框架设计

  ---------------------------------------------------------------------------
  阶段    目标点类型              候选集状态           评估目的
  ------- ----------------------- -------------------- ----------------------
  Phase 1 域内目标 (In-domain)    完备 (含真实目标)    理想条件下的性能上界

  Phase 2 域外目标                完备 (含真实目标)    目标泛化能力
          (Out-of-domain)                              

  Phase 3 域内目标 (In-domain)    不完备               候选缺失时的鲁棒性
                                  (缺失真实目标)       
  ---------------------------------------------------------------------------

Phase
1评估模型在理想条件下的性能上界，此时目标点在训练时已见过且候选集包含真实目标，模型可充分利用目标先验知识。Phase
2评估模型对未知目标的泛化能力，目标点虽未在训练集出现但候选集仍包含真实目标，考察模型能否正确识别新目标。Phase
3评估模型在候选集缺失真实目标时的鲁棒性，此时模型必须依赖历史轨迹和环境信息进行合理预测，考察轨迹生成器的纠错能力。

三阶段评估结果

本节按照三阶段评估框架，系统比较各模型在不同条件下的性能表现。实验数据来源于Bohemian
100km区域，Phase 1验证集包含893个样本（域内目标），Phase
2验证集包含912个样本（域外目标“Linz Industrial Port”）。

Phase
1评估在理想条件下进行，即目标为域内POI且候选集完备。表4.6给出了各模型的实验结果。

表4.6 Phase 1实验结果

  ------------------------------------------------------------------------
  模型                         ADE (km)              FDE (km)
  ---------------------------- --------------------- ---------------------
  本文模型                     1.23                  1.82

  YNet                         1.35                  1.91

  PECNet                       3.01                  5.30

  SimpleLSTM                   4.83                  8.65
  ------------------------------------------------------------------------

在该条件下，本文模型取得最优性能，ADE为1.23 km，FDE为1.82
km。相比次优的YNet，ADE降低8.9%，FDE降低4.7%。这得益于目标分类器能够准确识别正确的候选终点，为轨迹生成器提供可靠的目标约束。PECNet和SimpleLSTM的性能明显较差，说明在长时域预测任务中，目标驱动的架构设计具有显著优势。

[Phase 1 模型对比]

图4.7 Phase 1各模型ADE/FDE定量对比

图4.7a展示了Phase
1条件下各模型的误差分布箱线图，可以观察到本文模型不仅均值最低，且方差也最小，表明预测结果的稳定性较高。

[Phase 1 误差分布]

图4.7a Phase 1各模型ADE误差分布箱线图

图4.7b展示了预测误差随时间的变化趋势。可以看到，所有模型的误差都随预测时长增加而增大，但本文模型的误差增长速率最低，在60分钟预测时仍能保持较低的累积误差，这得益于层次化解码器和Waypoint机制对长时域误差累积的有效抑制。

[Phase 1 误差随时间变化]

图4.7b Phase 1预测误差随时间变化曲线

图4.7c以2×3网格形式展示了6个典型样本的轨迹预测可视化结果。每个子图中，绿色实线为历史观测轨迹，红色虚线为真实未来轨迹，蓝色线为本文模型预测，其他颜色分别对应YNet、PECNet和SimpleLSTM的预测结果。背景为DEM地形晕渲图，橙色星号标记候选目标位置。

[Phase 1 轨迹对比网格]

图4.7c Phase 1典型样本轨迹预测可视化（2×3网格）

从图4.7c可以观察到：本文模型（蓝色）在大多数样本中都能准确预测轨迹走向，尤其在存在地形约束的区域表现出色；YNet（绿色）整体表现良好但在长距离预测时存在偏移；PECNet（橙色）输出多条候选轨迹但分散度较大；SimpleLSTM（紫色）预测过于平滑，无法捕捉复杂转弯。

图4.7d进一步展示了按轨迹特征分层的预测结果矩阵，横轴为轨迹曲折度（sinuosity），纵轴为航向变化幅度，每个格子展示对应特征区间的典型预测案例。该可视化有助于分析模型在不同难度轨迹上的表现差异。

[Phase 1 分层轨迹矩阵]

图4.7d Phase 1按轨迹特征分层的预测结果矩阵

Phase
2评估测试模型对未见目标的泛化能力，目标为训练时未见的POI但候选集仍包含真实目标。表4.7给出了各模型的实验结果。

表4.7 Phase 2实验结果

  ------------------------------------------------------------------------
  模型                         ADE (km)              FDE (km)
  ---------------------------- --------------------- ---------------------
  本文模型                     35.48                 64.08

  YNet                         9.10                  15.20

  PECNet                       4.10                  7.20

  SimpleLSTM                   17.70                 32.00
  ------------------------------------------------------------------------

当目标为域外POI时，本文模型性能显著下降，ADE从1.23 km增至35.48
km，增幅达28倍。该现象表明目标分类器对域内POI存在过拟合，难以泛化到新的目标位置。相比之下，PECNet由于不依赖候选目标机制，展现出最强的泛化能力，ADE仅为4.10
km。

[Phase 2 模型对比]

图4.8 Phase 2各模型ADE/FDE定量对比

图4.8a展示了Phase 2条件下各模型的误差分布箱线图。与Phase
1相比，本文模型的误差分布出现显著右移，中位数和上四分位数都大幅增加，表明模型在未见目标上的预测存在系统性偏差。

[Phase 2 误差分布]

图4.8a Phase 2各模型ADE误差分布箱线图

图4.8b展示了Phase
2条件下预测误差随时间的变化趋势。本文模型的误差在预测初期（0-15分钟）与其他模型相近，但随后快速增长，说明目标分类器的错误选择在长时域预测中被逐渐放大。

[Phase 2 误差随时间变化]

图4.8b Phase 2预测误差随时间变化曲线

图4.8c展示了Phase
2条件下的典型轨迹预测可视化。可以清晰地观察到本文模型（蓝色）的预测轨迹偏向了错误的候选目标方向，而PECNet（橙色）虽然不知道真实目标位置，但基于历史运动模式的外推仍能保持相对合理的预测方向。

[Phase 2 轨迹对比]

图4.8c Phase 2典型样本轨迹预测可视化

Phase
3评估测试模型在候选集不完备时的鲁棒性，目标为域内POI但候选集中不包含真实目标。表4.8给出了各模型的实验结果。

表4.8 Phase 3实验结果

  ------------------------------------------------------------------------
  模型                         ADE (km)              FDE (km)
  ---------------------------- --------------------- ---------------------
  本文模型                     1.24                  1.83

  YNet                         20.35                 40.65

  PECNet                       20.91                 41.60

  SimpleLSTM                   4.83                  8.65
  ------------------------------------------------------------------------

当候选集中不包含真实目标时，本文模型仍能保持良好性能，ADE为1.24
km，与Phase 1几乎相同。而YNet和PECNet的性能急剧下降，ADE分别增至20.35
km和20.91
km。这一结果表明本文模型的轨迹生成器具有较强的纠错能力：即使目标分类器选择了错误的候选，LSTM解码器仍能根据历史运动模式和环境约束生成合理的轨迹，不会盲目朝向错误的目标位置移动。

[Phase 3 模型对比]

图4.9 Phase 3各模型ADE/FDE定量对比

图4.9a展示了Phase
3条件下不同候选目标数量对预测性能的影响。可以观察到，随着候选数量增加，YNet和PECNet的误差持续增大（因为更多错误候选的干扰），而本文模型保持稳定，验证了其对候选集质量的鲁棒性。

[Phase 3 候选数量对比]

图4.9a Phase 3不同候选数量下的轨迹预测对比

图4.9b展示了Phase
3条件下不同候选范围对预测性能的影响。实验设置了3km（集中对照）、10km、20km、30km四个候选范围梯度，候选终点均匀分布在以真实终点为圆心的环形区域内（内圈为外圈的80%）。结果表明，本文模型在不同候选范围下均保持稳定的预测性能，验证了其对候选集分布的鲁棒性。

[Phase 3 候选范围对比]

图4.9b Phase 3不同候选范围下的轨迹预测对比

图4.10以热力图形式综合展示了三阶段评估的结果，颜色深浅反映各模型在不同条件下的ADE表现。从图中可以清晰地观察到各模型的优势与局限：TerraTNT在Phase
1和Phase
3表现最优，体现了目标驱动架构和轨迹生成器纠错能力的优势；PECNet在Phase
2表现最优，说明其对未知目标的泛化能力较强；SimpleLSTM在所有阶段表现稳定但精度较低，反映了纯运动学方法的局限性。

[三阶段热力图]

图4.10 三阶段评估结果热力图

图中每个单元格的颜色深度表示该模型在对应阶段的ADE误差，颜色越深表示误差越大（性能越差）。横轴为评估阶段（Phase
1-3），纵轴为不同模型。可以观察到：(1) TerraTNT在Phase 1和Phase
3的单元格颜色最浅，表明在这两个阶段性能最优；(2) PECNet在Phase
2的单元格颜色较浅，显示其对未知目标的适应能力；(3)
SimpleLSTM的颜色分布较为均匀但整体偏深，说明其性能稳定但精度有限。

在目标位置已知或可靠推断的场景中（如基于任务规划的路径预测），TerraTNT能够提供高精度预测；而在目标完全未知的开放场景中，可能需要结合其他方法或采用多模态预测策略。

控制变量实验

本节通过控制变量实验，分析候选目标数量、观测长度和Waypoint数量等关键超参数对模型性能的影响，为实际应用中的参数选择提供指导。

候选目标数量

候选目标数量K决定了目标分类器的搜索空间大小。本实验将K从3扫描至20，观察其对预测精度和目标选择准确率的影响。

表4.10 候选目标数量K的影响

  -----------------------------------------------------------------------
  K值       ADE (km)             FDE (km)            EP@1 (%)
  --------- -------------------- ------------------- --------------------
  3         1.42                 2.01                49.6

  5         1.41                 2.23                20.4

  10        1.32                 1.96                6.8

  20        1.42                 1.91                2.7
  -----------------------------------------------------------------------

[K值影响]

图4.11 候选目标数量K对模型性能的影响

实验结果表明，K=10时模型取得最优的ADE性能（1.32
km）。当候选数量过少（K=3或5）时，真实目标可能未被纳入候选集，导致预测精度受限；当候选数量过多（K=20）时，过多的干扰项增加了目标分类器的选择难度，同样影响性能。EP@1指标随K增大而显著下降，从K=3时的49.6%降至K=20时的2.7%，这是因为候选越多，模型首选正确目标的难度越大。值得注意的是，FDE指标在不同K值下相对稳定，说明轨迹生成器对目标选择错误具有一定的容错能力。综合考虑预测精度和目标覆盖率，推荐K=10作为默认配置。

观测长度敏感性

历史观测长度决定了模型可获取的运动模式信息量。本实验将观测时长从3分钟扫描至15分钟（对应18-90个时间步）。

表4.11 观测长度敏感性分析

  ------------------------------------------------------------------------
  观测时长（分钟）            时间步数       ADE (km)       FDE (km)
  --------------------------- -------------- -------------- --------------
  3                           18             1.48           2.21

  6                           36             1.65           2.74

  9                           54             1.36           2.02

  12                          72             1.48           2.14

  15                          90             1.65           2.74
  ------------------------------------------------------------------------

[观测长度影响]

图4.12 观测长度对模型性能的影响

实验结果表明，9分钟观测时长取得最优性能，ADE为1.36
km。观测长度与预测精度之间呈现非单调关系：过短的观测（3分钟）无法捕捉完整的运动模式，模型难以准确推断车辆的运动意图；过长的观测（15分钟）则引入冗余信息和历史噪声，反而干扰模型的判断。该结果表明存在一个最优的观测窗口，在信息量和噪声之间取得平衡。对于实际应用，实时预测场景推荐采用6-9分钟的观测时长，在保证预测精度的同时降低系统延迟；对于离线分析等高精度需求场景，可采用9-12分钟的观测时长。

Waypoint数量影响

Waypoint数量决定了层级解码器的粒度。本实验将Waypoint数量从2扫描至12。

表4.12 Waypoint数量影响

  ------------------------------------------------------------------------
  Waypoint数量                   ADE (km)             FDE (km)
  ------------------------------ -------------------- --------------------
  2                              1.73                 2.57

  4                              1.73                 2.76

  6                              1.43                 1.92

  8                              1.73                 2.87

  10                             1.25                 1.98

  12                             1.31                 1.98
  ------------------------------------------------------------------------

[Waypoint数量影响]

图4.13 Waypoint数量对模型性能的影响

实验结果表明，Waypoint=10时模型取得最优的ADE性能（1.25
km）。Waypoint数量过少（2-4个）时，稀疏的关键点无法充分描述复杂轨迹的形状变化，特别是在存在多次转弯的场景中，ADE约为1.73
km。随着Waypoint数量增加，模型能够更精细地刻画轨迹骨架，预测精度逐步提升。然而，当Waypoint数量超过10个后，边际收益开始递减，过多的中间点增加了预测难度，且计算开销也相应增加。综合考虑预测精度和计算效率，推荐Waypoint数量设置为6-10个，其中6个适用于对实时性要求较高的场景，10个适用于对精度要求较高的场景。

消融实验

本节通过消融实验，量化模型各组件对最终性能的贡献，验证设计选择的合理性。

组件消融实验

为量化各模块对最终性能的贡献，本实验依次移除模型的关键组件，包括历史编码器、环境编码器、目标分类器，以及将LSTM解码器替换为简单的MLP解码器。所有变体模型在相同的训练配置下进行训练，并在Phase
1验证集上评估性能。表4.13给出了各配置的实验结果。

表4.13 组件级消融实验结果

  ------------------------------------------------------------------------
  配置                               ADE (km)   FDE (km)   ADE相对变化
  ---------------------------------- ---------- ---------- ---------------
  完整模型                           1.23       1.65       —

  无历史编码器                       1.53       2.38       +24.4%

  无环境编码器                       2.12       2.72       +72.4%

  无目标分类器                       1.42       2.05       +15.4%

  扁平解码器（MLP替代LSTM）          2.78       2.91       +126.0%
  ------------------------------------------------------------------------

[消融实验]

图4.14 组件消融实验结果

从实验结果可以分析各组件的重要性。LSTM解码器是最关键的组件，移除后ADE增幅达126.0%。这是因为简单的MLP解码器无法有效处理长距离时序预测任务，缺乏对时序依赖关系的建模能力。环境编码器的贡献同样显著，移除后ADE增加72.4%，验证了多源地理信息融合对野外轨迹预测的必要性。历史编码器移除后ADE增加24.4%，表明时序建模对于捕捉车辆运动模式不可或缺。目标分类器的贡献相对较小（+15.4%），但在候选集包含正确目标的场景中，其对预测精度的提升作用仍然明显。

特征消融实验

为分析不同类型地理信息对预测性能的贡献，本实验逐一移除环境编码器的输入通道类别。具体而言，分别测试移除DEM相关通道（高程、坡度、坡向）、移除LULC土地覆盖通道（11类地表类型）以及移除OSM道路通道后的模型性能。表4.14给出了各配置的实验结果。

表4.14 数据通道消融实验结果

  ------------------------------------------------------------------------
  配置                        ADE (km)     FDE (km)     ADE相对变化
  --------------------------- ------------ ------------ ------------------
  完整模型（18通道）          1.23         1.65         —

  无DEM（14通道）             1.42         2.05         +15.4%

  无LULC（7通道）             1.72         2.82         +39.8%

  无OSM（17通道）             1.29         1.87         +4.9%
  ------------------------------------------------------------------------

实验结果表明，不同类型的地理信息对预测性能的贡献存在显著差异。LULC土地覆盖信息的贡献最大，移除后ADE增加39.8%。这是因为土地覆盖类型直接决定了区域的可通行性，森林、水体、建筑区等类别对车辆运动构成明确约束，模型需要这些信息来规避不可通行区域。DEM高程信息的贡献同样显著，移除后ADE增加15.4%，在多山地形中尤为重要，帮助模型理解坡度、峡谷等地形约束对车辆路径选择的影响。OSM道路信息的贡献相对有限，移除后ADE仅增加4.9%。

跨区域泛化实验

前述实验均基于波西米亚森林单一区域的数据开展。然而，实际应用场景往往涉及多种地形条件，模型能否在不同地理环境下保持稳定的预测性能是评估其实用价值的关键问题。本节构建覆盖四个地理特征差异显著区域的多区域轨迹数据集，通过域内训练与跨区域测试相结合的实验设计，系统评估所提方法的泛化性能。

多区域数据集构建

基于第三章所述的轨迹生成方法，本研究选取四个具有代表性的地理区域构建多区域轨迹数据集。区域选取遵循三个原则：地形类型具有显著差异、地表覆盖特征多样、具备完整的环境数据支撑。各区域的地理特征如表4.15所示。

表4.15 多区域数据集地理特征

  -----------------------------------------------------------------------------------
  区域           地理位置               海拔范围(m)   地形类型   主要地表覆盖
  -------------- ---------------------- ------------- ---------- --------------------
  波西米亚森林   捷克-德国-奥地利边境   370-1456      低山丘陵   森林、沼泽、泥炭地

  顿巴斯         乌克兰东部             100-350       平原丘陵   草原、农田、工业区

  喀尔巴阡山     罗马尼亚中部           300-2544      中高山地   森林、高山草甸

  苏格兰高地     英国苏格兰北部         0-1345        高原山地   荒原、沼泽、湖泊
  -----------------------------------------------------------------------------------

上述四个区域在地形地貌方面存在显著差异。波西米亚森林属于欧洲古老山脉，经长期侵蚀作用山体呈圆润形态，区域内沼泽和泥炭地广泛分布，地形起伏相对平缓，车辆通行条件较好。顿巴斯位于东欧平原，地势平坦，海拔变化仅250米，以草原和农田为主要地表覆盖类型，是四个区域中地形最为简单的区域。喀尔巴阡山脉是欧洲第二长山脉，地形复杂多变，海拔跨度超过2200米，植被呈现明显的垂直分布特征，从低地阔叶林过渡到高山草甸，地形约束对车辆运动的影响显著。苏格兰高地具有典型的冰川侵蚀地貌特征，U型谷、冰斗湖等地貌单元广泛分布，地形崎岖破碎，加之大面积沼泽和湖泊的阻隔，车辆可通行路径受到严重限制。

为直观展示各区域环境特征的差异，首先通过可视化方式呈现四个区域的地形和土地覆盖实际情况。图4.19以2×2网格形式展示了四个区域的DEM晕渲图，直观呈现了地形起伏的视觉差异。波西米亚森林的地形呈现圆润的丘陵特征，海拔范围230-1438m；顿巴斯地势平坦，海拔仅-20至363m，是四个区域中最为平缓的；喀尔巴阡山地形复杂，海拔跨度最大（153-2236m），山脉走向清晰可见；苏格兰高地展现出典型的冰川侵蚀地貌，U型谷和冰斗湖特征明显，海拔范围-4至1334m。

[DEM对比]

4.19 四个区域地形对比（DEM晕渲图）

图4.20展示了四个区域的土地覆盖类型分布。波西米亚森林以森林覆盖为主（深绿色），同时包含较多草地和农田；顿巴斯的农田占比最高（金黄色），反映了其作为农业区的特点；喀尔巴阡山的森林覆盖率最高，植被呈现明显的垂直分布；苏格兰高地的草地占比高达70%以上（浅绿色），对应其广袤的荒原和高地草甸景观。这些土地覆盖差异直接影响车辆的通行能力和运动模式。

[LULC对比]

图4.20 四个区域土地覆盖对比（GlobeLand30分类）

多区域独立训练实验

为评估模型在不同地形条件下的预测性能，本研究在每个区域上独立训练TNT-Terrain模型。训练配置与4.2节保持一致：学习率0.001，批量大小32，最大训练轮数30，采用Adam优化器，验证集上连续5轮无改善则提前停止训练。各区域模型的训练过程如图4.27所示，横轴为训练轮次，纵轴为验证集ADE。

[训练曲线]

图4.24 各区域模型训练曲线

从训练曲线可以观察到各区域模型的收敛特性存在明显差异。波西米亚森林和顿巴斯的模型收敛较为平稳，验证集ADE在训练过程中持续下降，分别在第21轮和第10轮达到最优。喀尔巴阡山模型在第9轮达到最优后开始出现轻微过拟合。苏格兰高地模型的收敛行为最为特殊，仅在第3轮即达到最优性能，此后验证集误差持续上升，表现出严重的过拟合倾向。该现象可能与苏格兰高地轨迹长度分布的高度不均匀性有关：大量短轨迹使得模型难以学习到稳定的长期运动模式。

表4.17给出了各区域模型在验证集上的最优性能，图4.25以柱状图形式展示不同区域间的性能差异。

表4.17 各区域模型验证集性能

  -------------------------------------------------------------------------
  区域                地形类型      ADE(km)      FDE(km)      最优轮次
  ------------------- ------------- ------------ ------------ -------------
  波西米亚森林        低山丘陵      1.53         2.64         21

  顿巴斯              平原丘陵      2.03         3.25         10

  喀尔巴阡山          中高山地      1.98         3.29         9

  苏格兰高地          高原山地      4.41         8.15         3
  -------------------------------------------------------------------------

[区域性能对比]

图4.25 各区域模型性能对比

实验结果揭示了地形复杂度与预测难度之间的关联。波西米亚森林作为地形最为平缓的区域，模型取得了最优的预测性能（ADE=1.53
km）。顿巴斯和喀尔巴阡山的预测误差相近（ADE分别为2.03 km和1.98
km），尽管两者地形特征差异较大，但都属于模型能够有效学习的范畴。苏格兰高地的预测误差显著高于其他区域，ADE达到4.41
km，约为波西米亚森林的2.9倍。该结果与苏格兰高地复杂的冰川地貌特征一致：崎岖的地形导致车辆运动轨迹呈现高度不规则性，增加了预测难度。

值得注意的是，预测性能与样本数量并非简单的正相关关系。苏格兰高地拥有最多的训练样本（12,892个），但预测误差反而最大。这一现象表明，在轨迹预测任务中，数据质量（轨迹的完整性和规律性）比数据数量更为重要。地形复杂度是制约预测精度的主导因素，单纯增加样本数量无法弥补地形带来的预测难度。

跨区域泛化测试

跨区域泛化能力是评估模型实用价值的重要指标。在实际应用中，模型往往需要部署到训练数据未覆盖的新区域，此时模型能否保持合理的预测精度直接决定了其应用范围。为深入分析模型的跨区域泛化能力，本研究设计了交叉验证实验：使用在某一区域训练的模型对所有四个区域的验证集进行测试，构建4×4的跨区域性能矩阵。

实验配置如下：对于每个训练区域，加载该区域训练得到的最优模型（根据验证集ADE选择），然后在四个区域的验证集上分别进行推理，记录ADE和FDE指标。该实验设计能够同时评估域内性能（训练区域与测试区域相同）和域外性能（训练区域与测试区域不同），通过对比两者的差异量化泛化损失。

表4.18 跨区域泛化测试结果（ADE，单位：km）

  -------------------------------------------------------------------------
  训练区域＼测试区域     波西米亚森林    顿巴斯   喀尔巴阡山   苏格兰高地
  ---------------------- --------------- -------- ------------ ------------
  波西米亚森林           [1.53]          2.55     2.16         6.88

  顿巴斯                 2.94            [2.03]   2.39         6.46

  喀尔巴阡山             1.63            2.06     [1.98]       6.20

  苏格兰高地             5.14            3.98     4.56         [4.41]
  -------------------------------------------------------------------------

注：方括号内数值表示域内测试结果（训练区域与测试区域相同）。

[跨区域热力图]

图4.26 跨区域泛化测试热力图

从表4.18和图4.26可以观察到跨区域泛化的整体规律。矩阵对角线上的数值（域内测试）普遍低于同行或同列的其他数值（域外测试），表明模型在训练区域上的表现优于其他区域，这符合机器学习的一般规律。矩阵的最后一列（苏格兰高地作为测试区域）数值普遍较高，反映了苏格兰高地作为预测目标的固有难度。矩阵的最后一行（苏格兰高地模型）数值也普遍较高，说明在复杂地形上训练的模型并未获得更强的泛化能力，反而因过拟合于特定地形模式而在其他区域表现不佳。

为量化跨区域泛化带来的性能损失，本研究计算了各模型在域外测试时的平均ADE及其相对于域内测试的增幅，结果如表4.19和图4.27所示。

表4.19 跨区域泛化性能分析

  -------------------------------------------------------------------------
  训练区域         域内ADE(km)      域外平均ADE(km)        性能下降幅度
  ---------------- ---------------- ---------------------- ----------------
  波西米亚森林     1.53             3.86                   152%

  顿巴斯           2.03             3.93                   93%

  喀尔巴阡山       1.98             3.30                   66%

  苏格兰高地       4.41             4.56                   3%
  -------------------------------------------------------------------------

[泛化损失]

图4.27 域内测试与跨区域泛化测试性能对比

跨区域泛化实验揭示了若干重要发现。首先，跨区域泛化存在显著的性能损失。除苏格兰高地外，其他三个区域的模型在域外测试时ADE增幅均超过66%，波西米亚森林模型的增幅最高达152%。该结果表明，模型在训练过程中学习到了区域特定的地形模式和运动规律，这些知识难以直接迁移到地形特征不同的区域。

其次，在地形多样性较高的区域训练的模型具有更强的泛化能力。喀尔巴阡山模型的域外性能下降幅度最小（66%），且在波西米亚森林上的表现（ADE=1.63
km）甚至优于波西米亚森林模型自身（ADE=1.53
km）仅略低。喀尔巴阡山地形复杂多变，海拔跨度大，包含从平原到高山的多种地形类型，模型在该区域训练时接触到了更丰富的地形模式，因此学习到的特征表示更具普适性。

第三，区域间的迁移特性呈现非对称性。喀尔巴阡山模型在波西米亚森林上的ADE为1.63
km，而波西米亚森林模型在喀尔巴阡山上的ADE为2.16 km，两者相差0.53
km。类似的非对称性在其他区域对之间也存在。该现象说明，从地形复杂区域向地形简单区域的迁移相对容易，反之则较为困难。这一发现对实际应用具有指导意义：在训练数据选择时，应优先考虑地形多样性较高的区域。

最后，苏格兰高地模型的泛化损失最小（3%），但这一结果需要谨慎解读。该模型的域内性能本身较差（ADE=4.41
km），在其他区域的表现与域内相近并非源于良好的泛化能力，而是因为模型未能有效学习到苏格兰高地的地形特征，其预测行为更接近于基于历史轨迹的简单外推，因此在不同区域的表现差异不大。

本章小结

本章围绕长时域轨迹预测问题，提出了一种融合多源地理信息的目标驱动预测方法，并通过系统的实验验证了方法的有效性。

在模型设计方面，本章提出了包含环境编码器、历史轨迹编码器、目标分类器和轨迹生成器的四模块架构。环境编码器采用多层卷积网络提取18通道栅格地图的空间特征，历史轨迹编码器采用双层LSTM网络捕捉时序运动模式，两者的特征通过拼接融合后输入目标分类器进行候选终点评分。轨迹生成器采用层次化解码策略，首先生成稀疏的中间关键点作为轨迹骨架，然后对各段进行精细化预测，有效缓解了长序列预测中的误差累积问题。

在评估框架方面，本章设计了三阶段评估体系，分别测试模型在已知目标、未见目标、候选集包含真实目标、候选集不包含真实目标等不同条件下的性能表现。该框架为轨迹预测模型的泛化能力评估提供了标准化流程，能够全面揭示模型的优势与局限。

在实验验证方面，本章通过基线对比、控制变量和消融实验，系统评估了所提方法的性能。基线对比实验表明，本文模型在已知目标场景下达到最优性能（ADE=1.23
km）。消融实验揭示了各模块的贡献度，其中环境编码器和LSTM解码器是影响性能的关键组件，移除后ADE分别增加39.8%和126.0%。控制变量实验给出了候选数量、观测时长和Waypoint数量的推荐配置。

在跨区域泛化方面，本章在四个地形特征差异显著的区域上验证了模型的适应性。实验结果表明，模型能够在不同地形条件下有效训练，验证了架构的通用性。地形复杂度是影响预测难度的主导因素，苏格兰高地的预测误差约为平原地区的2.9倍。跨区域泛化存在显著的性能损失，平均下降幅度约为78%，该结果为后续域适应研究指明了方向。在地形多样性较高的区域训练的模型展现出更强的跨区域迁移能力，这一发现对实际应用中的训练数据选择具有参考价值。

综上所述，本章提出的目标驱动轨迹预测方法在已知目标场景下表现优异，在多区域验证中展现了良好的适应性。然而，模型对未见目标的泛化能力和跨区域迁移能力仍有提升空间，后续研究可探索域适应技术和多区域联合训练策略，进一步增强模型的通用性。

总结与展望

本文针对多星协同对地观测系统中的动目标轨迹生成与预测问题开展了系统性研究。通过构建环境约束模型、设计数据驱动的轨迹生成方法以及开发基于深度学习的意图感知预测框架，为空窗期内的目标位置预测提供了方案。本章对研究工作进行总结，分析存在的局限性，并对未来研究方向进行展望。

主要研究工作

针对复杂地理环境下的目标运动特性，本文构建了一套环境约束模型。通过整合数字高程模型和地表覆盖数据，建立了30米分辨率的环境代价地图，实现了对研究区域地形和地表特性的统一表达。在此基础上，设计了包含基础距离成本、坡度成本、地表类型成本和暴露度成本的综合代价函数，并提出了标准、隐蔽优先、高机动性、山地特种四种典型场景的权重配置方案。在环境代价地图基础上，通过A*算法生成初始路径集，为后续的轨迹生成奠定了基础。

为将静态路径转化为具有时序特征的动态轨迹，通过分析真实越野数据集，建立了环境特征与速度的定量关系模型。证明了环境特征对目标运动速度的影响。并在速度预测基础上施加了最大速度、加速度等约束，最终生成了符合物理规律的轨迹数据集。

针对目标意图不确定性问题，设计了基于深度学习的概率预测方法。该方法构建了包含历史轨迹、环境特征和潜在目的地信息的输入表示。采用门控循环单元提取轨迹时序特征，通过混合密度网络建模预测的不确定性，输出高斯混合模型未来轨迹分布。通过在仿真数据集中的验证，证明了该方法的有效性和实用价值。

当前研究的不足

当前研究在环境建模方面仍存在一些局限。首要问题是环境数据的限制，现有的环境数据维度比较少，分辨率也比较低，无法刻画更精细的地形特征，这在一定程度上影响轨迹数据集生成时的准确性。其次，环境代价模型主要考虑了静态地理特征，对于天气、季节等动态环境因素的影响考虑不足。虽然提出了四种典型场景的代价配置，但对于极端天气、应急响应等特殊任务场景的适应性仍有待验证。这些局限性在实际应用中可能导致模型性能的下降。

在轨迹生成方面，本文提出的方法主要受到可供学习的数据量的制约。此外，当前采用的运动学约束基于简单假设，实际目标的机动特性会更为复杂，这在不同任务场景下可能导致生成轨迹与实际运动规律产生偏差。

预测框架的主要局限体现在长期预测能力和模型复杂度两个方面。随着预测时间跨度的增加，预测不确定性会快速增长。同时，模型对预定义的潜在目的地集合存在依赖，不能处理目的地动态变化或临时改变的情况。这些问题都需要在未来的研究中得到进一步解决。

未来研究展望

未来研究中，可以展望的方向包括以下几点：

通过引入更高分辨率的遥感影像和地形数据，可以提升环境特征表达的精细度。同时，可以将包含天气、季节变化、敌方目标等动态因素纳入环境约束模型，提高系统对实际场景的适应性。结合专家经验和历史数据构建更智能的场景自适应机制，也将有助于提升环境建模的实用性和可靠性。

在轨迹生成方法方面，引入更复杂的车辆动力学模型，将有助于提高生成轨迹的合理性，使其更好地反映实际目标的运动特征。

预测框架可以进一步提升复杂度。通过引入空间-时间注意力机制，可以提升模型对长期依赖关系的捕捉能力。研究轨迹实时观测的目的地动态推理方法，将有助于减少对先验知识的依赖，也能增强对陌生场景的适应性。

本章小结

本章系统总结了论文的主要研究工作，包括环境约束建模、数据驱动的轨迹生成以及基于深度学习的预测框架等核心内容。通过分析研究局限性，明确了当前方法在环境表达、数据依赖等方面存在的不足。针对这些问题，提出了环境建模增强、轨迹生成改进、预测框架升级等未来研究方向，为后续工作指明了方向。

参考文献

1.  王笑梦.坦克“陆战之王”地位依然稳固——从俄军在乌克兰启用T-54B坦克谈起[J].坦克装甲车辆,2023,(11):25-30.DOI:10.19486/j.cnki.11-1936/tj.2023.11.005.

2.  刘洪蕊,王结良,吴剑锋,等.俄乌冲突侦察监视与伪装对抗应用分析[J].激光与红外,2024,54(04):620-625.

3.  Polack, P., Altché, F., d'Andréa-Novel, B., de La Fortelle, A. The
    kinematic bicycle model: A consistent model for planning feasible
    trajectories for autonomous vehicles? IEEE IVS, 2017: 812-818.

4.  Werling, M., Ziegler, J., Kammel, S., Thrun, S. Optimal trajectory
    generation for dynamic street scenarios in a frenet frame. IEEE
    ICRA, 2010: 987-993.

5.  Blom, H.H.A.P., Bar-Shalom, Y. The Interacting Multiple Model
    Algorithm for Systems with Markovian Switching Coefficients. IEEE
    TAC, 1988, 33(8): 780-783.

6.  Zhen, X., Zhao, W. Application of Road Information in Ground Moving
    Target Tracking. Chinese Journal of Aeronautics, 2007, 20(6):
    529-538.

7.  Vashishtha, D., Panda, M. Maximum Likelihood Multiple Model
    Filtering for Path Prediction in Intelligent Transportation Systems.
    Procedia Computer Science, 2018, 143: 635-644.

8.  Berndt, H., Emmert, J., Dietmayer, K. Continuous driver intention
    recognition with hidden markov models. IEEE ITSC, 2008: 1189-1194.

9.  Qiao, S., Shen, D., Wang, X., Han, N., Zhu, W. A self-adaptive
    parameter selection trajectory prediction approach via hidden markov
    models. IEEE TITS, 2015, 16(1): 284-296.

10. Deng, Q., Söffker, D. Improved driving behaviors prediction based on
    fuzzy logic-hidden markov model (fl-hmm). IEEE IVS, 2018: 2003-2008.

11. Lefèvre, S., Laugier, C., Ibañez-Guzmán, J. Exploiting map
    information for driver intention estimation at road intersections.
    IEEE IVS, 2011: 583-588.

12. Schreier, M., Willert, V., Adamy, J. An integrated approach to
    maneuver-based trajectory prediction and criticality assessment in
    arbitrary road environments. IEEE TITS, 2016, 17(10): 2751-2766.

13. Wiest, J., Höffken, M., Kreßel, U., Dietmayer, K. Probabilistic
    trajectory prediction with Gaussian mixture models. IEEE IVS, 2014:
    141-146.

14. Guo, Y., Kalidindi, V.V., Arief, M., Wang, W., Zhu, J., Peng, H.,
    Zhao, D. Modeling multi-vehicle interaction scenarios using gaussian
    random field. IEEE ITSC, 2019: 3974-3980.

15. Alahi, A., Goel, K., Ramanathan, V., Robicquet, A., Fei-Fei, L.,
    Savarese, S. Social LSTM: Human trajectory prediction in crowded
    spaces. IEEE CVPR, 2016: 961-971.

16. Wang, Y., Gao, Z., Long, M., Wang, J., Yu, P.S. PredRNN: Recurrent
    Neural Networks for Predictive Learning using Spatiotemporal LSTMs.
    NIPS, 2017: 879-888.

17. Dai, S., Li, L., Li, Z. Modeling vehicle interactions via modified
    LSTM models for trajectory prediction. IEEE Access, 2019, 7:
    38287-38296.

18. Yu, B., Yin, H., Zhu, Z. Spatio-Temporal Graph Convolutional
    Networks: A Deep Learning Framework for Traffic Forecasting. IJCAI,
    2018: 3634-3640.

19. Giuliari, F., Hasan, I., Cristani, M., Galasso, F. Transformer
    Networks for Trajectory Forecasting. arXiv preprint
    arXiv:2003.08111v3, 2020.

20. Shi, Z., Zhang, X., Li, J., Wei, Z. Deep Kalman-based Trajectory
    Estimation of Moving Target from Satellite Images. IEEE ITAIC, 2022:
    1373-1378.

21. Zhao, M., Kathner, D., Jipp, M., Soffker, D., Lemmer, K. Modeling
    driver behavior at roundabouts: Results from a field study. IEEE
    IVS, 2017: 908-913.

22. Zyner, A., Worrall, S., Ward, J., Nebot, E. Long short term memory
    for driver intent prediction. IEEE IVS, 2017: 1484-1489.

23. Xin, L., Wang, P., Chan, C.-Y., Chen, J., Li, S.E., Cheng, B.
    Intention-aware Long Horizon Trajectory Prediction of Surrounding
    Vehicles using Dual LSTM Networks. IEEE ITSC, 2018: 3172-3179.

24. Goldhammer, M., Köhler, S., Zernetsch, S., Doll, K., Sick, B.,
    Dietmayer, K. Intentions of vulnerable road users—detection and
    forecasting by means of machine learning. IEEE TITS, 2020, 21(7):
    3035-3045.

25. Wu, H., Wang, L., Zheng, S., Xu, Q., Wang, J. Crossing-road
    pedestrian trajectory prediction based on intention and behavior
    identification. IEEE ITSC, 2020: 1-6.

26. Muhammad, N., Åstrand, B. Intention estimation using set of
    reference trajectories as behaviour model. Sensors, 2018, 18(12):
    4423.

27. Mangalam, K., Girase, H., Agarwal, S., Lee, K.-H., Adeli, E., Malik,
    J., Gaidon, A. It is not the journey but the destination: Endpoint
    conditioned trajectory prediction. ECCV, 2020: 759-776.

28. Zhao, H., Gao, J., Lan, T., Sun, C., Sapp, B., Varadarajan, B.,
    Shen, Y., Chai, Y., Schmid, C., TNT: Target-driven trajectory
    prediction. CoRL, 2020: 1-12.

29. Xu, Y., Yang, Z., Zhou, X., et al. Remember intentions:
    Retrospective-memory-based trajectory prediction. IEEE/CVF CVPR,
    2022: 6488-6497.

30. Zhou, X., Fu, H., Tang, Y., et al. Queried center prediction for
    trajectory forecasting. IEEE/CVF ICCV, 2023: 12343-12354.

31. Kucner, T., Saarinen, J., Magnusson, M., Lilienthal, A.J.
    Conditional transition maps: Learning motion patterns in dynamic
    environments. IEEE IROS, 2013: 5009-5015.

32. Hohmann, A., Grandjean, G., Maréchal, J., Hoberman, R.,
    Crescenzo, D. A GIS-based Vehicle Mobility Estimator for Operational
    Contexts. Transactions in GIS, 2013, 17(1): 78-95.

33. Rybansky, M., Vala, M., Malina, R. Modelling of cross-country
    transport in raster format. Environmental Earth Sciences, 2015, 74:
    7049-7058.

34. 赵芊. 基于地理信息系统的全地形车路径规划技术研究.
    中国航天科技集团公司第一研究院, 2016.

35. Ahn, J., Cha, G., Jung, J.Y., Park, S.-I., Kim, D. A study on
    unmanned combat vehicle path planning for collision avoidance with
    enemy forces in dynamic situations. Journal of Computational Design
    and Engineering, 2023, 10(6): 2251-2270.

36. Zhang, Y., Li, X., Xue, Y. On Hierarchical Path Planning Based on
    Deep Reinforcement Learning in Off-Road Environments. IEEE ICARA,
    2024.

37. 田洪清, 林晨, 张炎顺, 王庆林.
    越野环境下势场搜索树智能车辆路径规划方法. 兵工学报, 2024, 45(7):
    2110-2118.

38. 夏忠.多类型观测任务的多星协同规划问题研究[D].合肥工业大学,2020.DOI:10.27101/d.cnki.ghfgu.2020.001732.

39. 汪韬阳,洪建智,张过,等.舰船目标运动状态光学卫星视频监测与估计[J].测绘学报,2023,52(10):1679-1692.

40. M. Gadd et al., "OORD: The Oxford Offroad Radar Dataset," in IEEE
    Transactions on Intelligent Transportation Systems, vol. , no. , pp.
    -, Nov. , doi: ./TITS..

致 谢

感谢那些在我成长路上给予我支持、帮助与鼓励的人们。

首先，我要感谢我的父母。是你们用无私的爱为我撑起一片温暖的天空，让我在无忧无虑的环境中成长。无论我遇到什么困难，你们总是耐心倾听，给予我最坚定的支持。你们的鼓励是我不断前行的动力，你们的教诲让我学会了如何做人。感谢你们为我付出的一切，我会永远铭记在心。

感谢我的导师，不仅在学术上给予我悉心指导，更在人生道路上为我指明方向。您严谨的治学态度、渊博的学识和高尚的品德，深深影响着我。在研究过程中，您耐心解答我的每一个疑问，帮助我克服重重困难。

感谢我的同学和朋友们，是你们让我的生活充满了欢声笑语。我们一起度过了无数难忘的时光，一起学习、一起成长。感谢你们的陪伴，让我的生活更加丰富多彩。

感恩相遇，感谢陪伴。未来，我会带着这份感恩，继续前行，努力成为一个更好的自己，回报所有帮助过我的人。

个人简历、在学期间完成的相关学术成果

个人简历

2000年11月05日出生于安徽六安市。

2017年9月考入天津大学精密仪器系测控技术与仪器专业，2021年7月本科毕业并获得工学学士学位。

2022年9月统招进入清华大学精密仪器系攻读电子信息硕士至今。

在学期间完成的相关学术成果

无。
