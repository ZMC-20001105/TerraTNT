# 论文 vs 项目 差距分析

## 一、模型对应关系

| 论文中名称 | 项目中对应 | 状态 |
|---|---|---|
| **本文模型 (TerraTNT)** | V6R_Robust (runs/incremental_models_v6r/V6_best.pth) | ✅ 有模型，有评估 |
| **YNet** | ynet_faithful (runs/ynet_faithful/) | ⚠️ 有模型文件，但V5评估中用的是LSTM_Env_Goal，不是真正的YNet |
| **PECNet** | pecnet_faithful (runs/pecnet_faithful/) | ⚠️ 有模型文件，但V5评估中用的是Seq2Seq_Attn，不是真正的PECNet |
| **SimpleLSTM** | LSTM_only (runs/LSTM_only_d1/) | ✅ 有模型，有评估 |

### 关键问题：论文中的对比模型 ≠ 项目中实际评估的模型

论文写的是与 YNet、PECNet、SimpleLSTM 对比，但项目中：
- V5评估 (`phase_diagnostic_v5`) 用的对比模型是：LSTM_Env_Goal, Seq2Seq_Attn, LSTM_only, MLP 等自建baseline
- V2评估 (`phase_v2`) 用的也是这些自建baseline
- 虽然项目中有 `ynet_faithful.py` 和 `pecnet_faithful.py` 的实现和训练好的模型，但**没有用这些模型做过Phase评估**

## 二、评估Phase体系差异

| 论文中Phase | 论文定义 | 项目中对应 | 状态 |
|---|---|---|---|
| Phase 1 | 域内目标 + 候选集完备 | V5的fas1 | ✅ 有数据 |
| Phase 2 | 域外目标 + 候选集完备 | V5的fas2 | ✅ 有数据 |
| Phase 3 | 域内目标 + 候选集不完备 | V5的fas3 | ✅ 有数据 |

项目中还有V2评估体系(P1a/P1b/P2a-c/P3a-b)，这是基于热力图先验质量的评估，**与论文中的Phase定义不同**。

## 三、论文中的实验数据 vs 项目实际数据

### 表4.6 Phase 1 (论文数据)
| 模型 | ADE(km) | FDE(km) |
|---|---|---|
| 本文模型 | 1.23 | 1.82 |
| YNet | 1.35 | 1.91 |
| PECNet | 3.01 | 5.30 |
| SimpleLSTM | 4.83 | 8.65 |

### 项目V5 fas1实际数据 (用的不同模型)
| 模型 | ADE(m) |
|---|---|
| V6R_Robust | 1068 |
| LSTM_Env_Goal | 1401 |
| Seq2Seq_Attn | 5983 |
| LSTM_only | 7721 |

**差异**：
- V6R的ADE=1068m(1.07km) vs 论文写1.23km → 数值不匹配
- LSTM_Env_Goal的ADE=1401m(1.40km) vs 论文YNet=1.35km → 不是同一个模型
- Seq2Seq_Attn的ADE=5983m(5.98km) vs 论文PECNet=3.01km → 完全不同的模型
- LSTM_only的ADE=7721m(7.72km) vs 论文SimpleLSTM=4.83km → 数值差距大

### 表4.7 Phase 2 (论文数据)
| 模型 | ADE(km) |
|---|---|
| 本文模型 | 35.48 |
| YNet | 9.10 |
| PECNet | 4.10 |
| SimpleLSTM | 17.70 |

### 项目V5 fas2实际数据
| 模型 | ADE(m) |
|---|---|
| V6R_Robust | 2896 |
| LSTM_Env_Goal | 2027 |

**差异**：论文中本文模型Phase2 ADE=35.48km，但项目中V6R在fas2只有2.90km → 数值完全不匹配

### 表4.13 消融实验 (论文数据)
| 配置 | ADE(km) | 变化 |
|---|---|---|
| 完整模型 | 1.23 | — |
| 无历史编码器 | 1.53 | +24.4% |
| 无环境编码器 | 2.12 | +72.4% |
| 无目标分类器 | 1.42 | +15.4% |
| MLP替代LSTM | 2.78 | +126.0% |

项目中有 `runs/ablation/` 目录但只有 `results_pecnet.json`，**没有完整的消融实验数据**。

### 表4.14 环境通道消融 (论文数据)
| 配置 | ADE(km) | 变化 |
|---|---|---|
| 完整(18通道) | 1.23 | — |
| 无DEM(14通道) | 1.42 | +15.4% |
| 无LULC(7通道) | 1.72 | +39.8% |
| 无OSM(17通道) | 1.29 | +4.9% |

项目中**没有环境通道消融实验的数据**。

## 四、跨区域实验差异

### 论文描述：4个区域
| 区域 | 论文中域内ADE |
|---|---|
| 波西米亚森林 | 1.53 km |
| 顿巴斯 | 2.03 km |
| 喀尔巴阡山 | 1.98 km |
| 苏格兰高地 | 4.41 km |

### 项目实际：只有2个区域的环境数据
- ✅ bohemian_forest: 23个tif文件
- ✅ scottish_highlands: 21个tif文件
- ❌ donbas: 无环境数据
- ❌ carpathian: 无环境数据

论文中的4×4跨区域矩阵(表4.18)、4区域训练曲线、4区域DEM/LULC可视化 → **缺少2个区域的数据，无法生成**

### 环境数据覆盖范围问题
- 波西米亚森林: 约112km × 114km (够用但偏小)
- 苏格兰高地: 约125km × 226km
- 论文要求100km级别的轨迹，环境数据覆盖范围可能不足以生成足够多样的轨迹

## 五、控制变量实验差异

### 论文中有但项目中缺失的实验：
1. **候选数量K影响** (表4.9): K=3,5,10,20 → 项目中无此实验数据
2. **观测时长影响** (表4.10): 3-15分钟 → 项目中无此实验数据
3. **Waypoint数量影响** (表4.11): 2-10个 → 项目中无此实验数据
4. **Phase 3候选数量/范围敏感性** (图4.9) → 项目中无此实验数据

## 六、可视化图表差异

### 论文需要但项目中缺失的图表：
1. **图4.1-4.5**: 模型架构图 (draw_architecture_diagram.py已打开但未完成)
2. **图4.6**: 训练曲线 → 有部分日志但不完整(只有15epoch，论文说25epoch最优)
3. **图4.X**: Phase1/2/3的轨迹预测可视化(含DEM背景) → 需要用YNet/PECNet模型重新生成
4. **图4.X**: 按sinuosity分层的预测矩阵 → 需要新实验
5. **图4.19/4.20**: 四区域DEM/LULC → 缺2个区域数据
6. **图4.X**: 四区域训练曲线 → 缺2个区域
7. **图4.25-4.27**: 跨区域实验图 → 缺2个区域

## 七、总结：需要做的工作

### 必须做的（论文数据和项目不匹配）：
1. **用YNet和PECNet模型重新跑Phase 1/2/3评估** — 论文对比的是这两个模型，不是LSTM_Env_Goal和Seq2Seq_Attn
2. **确认论文中的数值来源** — 论文表4.6/4.7/4.8中的数值与项目评估结果不匹配，需要确认是哪个版本的实验
3. **补做消融实验** — 表4.13(模块消融)和表4.14(通道消融)在项目中没有数据
4. **补做控制变量实验** — 候选数量K、观测时长、Waypoint数量

### 需要额外数据的（环境数据缺失）：
5. **获取顿巴斯和喀尔巴阡山的环境数据** — 需要下载DEM、LULC、OSM数据
6. **扩大已有区域的环境数据覆盖范围** — 当前覆盖可能不足

### 可以从现有数据生成的：
7. **模型架构图** — 纯绘图，不需要数据
8. **训练曲线** — 可以从现有日志提取或重新训练
9. **Phase 1/2/3的箱线图和时间趋势图** — 有per-sample数据（但需要用正确的模型）
